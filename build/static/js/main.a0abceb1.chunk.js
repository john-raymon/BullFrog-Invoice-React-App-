(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){"use strict";(function(e){var n=a(249),l=a.n(n),o=a(250),r=a.n(o),s=l()(r.a,e.Promise),i=function(e){return e.body},c=null,m=function(e){console.log("the token object right now!",c),c&&e.set("authorization","".concat(c))},u={del:function(e){return s.del("".concat("/").concat(e)).use(m).then(i)},get:function(e){return s.get("".concat("/").concat(e)).use(m).then(i)},put:function(e,t){return s.put("".concat("/").concat(e),t).use(m).then(i)},post:function(e,t){return s.post("".concat("/").concat(e),t).use(m).then(i)},postImage:function(e,t){return s.post("".concat("/").concat(e)).use(m).attach("invoiceImages",t).then(i)}};t.a={Auth:{login:function(e,t){return u.post("users/login",{email:e,password:t})}},requests:u,setToken:function(e){c=e}}}).call(this,a(35))},258:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAs1JREFUSA21lslqVUEQQI2zOE/BGRKNRAUnHJaiXyAiguJGshLc+CWCoIv8QMSV/kJUVHBYGKMLpyQqUeMAznE8J6Sf9frdvJsXTMHhVldX3+quqtvvNU0pl+W4rIVm2Aq98AoGYBAakqY63tuY2wdtMLvAbxjbE+iGO/ALSqUo4CJWHYHdpav/OfSgXgBPXlemZbMrGZ+C9sxeNjTdZsQTv6/nHE/oyU7DqmzBc8Z3oQ8+g+m1ptuhFaK8Y3AGBqMx6ingVIwdsCdMfke/BFdAPZfpGPbCYZgXJh+in4UfwVZRU0q3YDkEaQPf0DvhBozVDL+ZG4BHYDpngbIMXoNzNeLJDLJ/9JkcPNm9NCh5Pma+C/4EP99nBmrEgEtgY5hxZ91hPB71Nk6mMsk6lNVpEJ8GdNJGSHILpTD/yaHgaXpvBrvvbQnjiuqEN0mUZ3HQgN6Pb6y3n0qNGDB+4NbhU43X+AxfcfsZXGPWKmYDxtzbQKnbKk7jVGbgl7reJYVlMeALZ4N420xEVrAodmbhjWNAb5KY+x0TicaafF1f0XsM6DUUP9JNjDcXOdex2ek7w/wQ+pgBLfTV4GwdjsHSYKunzmfyOMTaX2P8pWhRKrI/K15vXuCKd6MndZcfYCyx3h2wPjhYnstQWMMU0FPaPLsgFX4Bupe5m/Dy9gfXLp4Da+AAHIW8ySxTC/SCvy5V4guiGPAEzIzGUf0jTy9159xMvhZTlbxkdA68yCuSTpgMOvWDKZqbjKNPa6TNDzoP5oWR26xtO9yHSj3zgMyN7MjL2Bc0Q2wGhlXii67DRdA3bzQzURU03xXzVbKYkc3TCv7OGdwb5C08hQfwBpSFcBLMTi5+66Z3qCxgvrBsbIMZ1A3mMoChsyiluWMjY5uqBzaA2YliBob/d0ADpKBt6DGoN1rXZATMg5pmg52HVG99JkXs2oPg35gR+QtuoXwKGm7ejAAAAABJRU5ErkJggg=="},274:function(e,t,a){e.exports=a(510)},295:function(e,t){},346:function(e,t){},348:function(e,t){},387:function(e,t){},388:function(e,t){},509:function(e,t,a){},510:function(e,t,a){"use strict";a.r(t);var n,l=a(1),o=a.n(l),r=a(246),s=a.n(r),i=a(33),c=a(248),m=a(94),u=a(50),p=a(4),d={isAuth:!1,token:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"LOGIN".concat("_FULFILLED"):return Object(p.a)({},e,{token:l.token,isAuth:l.isAuth});case"LOGOUT":case"LOGIN".concat("_REJECTED"):return Object(p.a)({},e,{token:null,isAuth:!1});case"CHANGE":return Object(p.a)({},e,{isAuth:!0});default:return e}},b={authLoading:!1,dashboard:{invoicesToDo:!1,customers:!1,allInvoices:!1},globals:{settings:!1}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0,a=t.type;t.payload;switch(a){case"LOGIN".concat("_FULFILLED"):return Object(p.a)({},e,{authLoading:!1});case"LOGIN".concat("_PENDING"):return Object(p.a)({},e,{authLoading:!0});case"LOGOUT":case"LOGIN".concat("_REJECTED"):return Object(p.a)({},e,{authLoading:!1});case"FETCH_SETTINGS_PENDING":return Object(p.a)({},e,{globals:Object(p.a)({},e.globals,{settings:!0})});case"FETCH_SETTINGS_FULFILLED":case"FETCH_SETTINGS_REJECTED":return Object(p.a)({},e,{globals:Object(p.a)({},e.globals,{settings:!1})});case"FETCH_ALL_INVOICES_PENDING":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:!0})});case"FETCH_ALL_INVOICES_FULFILLED":case"FETCH_ALL_INVOICES_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:!1})});case"FETCH_INVOICES_TO_DO_PENDING":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:!0})});case"FETCH_INVOICES_TO_DO_FULFILLED":case"FETCH_INVOICES_TO_DO_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:!1})});case"FETCH_KNACK_CUSTOMERS_PENDING":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:!0})});case"FETCH_KNACK_CUSTOMERS_FULFILLED":case"FETCH_KNACK_CUSTOMERS_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:!1})});default:return e}},g={dashboard:{invoicesToDo:null,customers:null,allInvoices:null},globals:{settings:null}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"FETCH_SETTINGS_PENDING":case"FETCH_SETTINGS_FULFILLED":return Object(p.a)({},e,{globals:{settings:null}});case"FETCH_SETTINGS_REJECTED":return Object(p.a)({},e,{globals:{settings:l}});case"FETCH_ALL_INVOICES_PENDING":case"FETCH_ALL_INVOICES_FULFILLED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:null})});case"FETCH_ALL_INVOICES_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:l})});case"FETCH_INVOICES_TO_DO_PENDING":case"FETCH_INVOICES_TO_DO_FULFILLED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:null})});case"FETCH_INVOICES_TO_DO_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:l})});case"FETCH_KNACK_CUSTOMERS_PENDING":case"FETCH_KNACK_CUSTOMERS_FULFILLED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:null})});case"FETCH_KNACK_CUSTOMERS_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:l})});default:return e}},v={invoicesToDo:{},customers:{},allInvoices:[]},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"FETCH_INVOICES_TO_DO_FULFILLED":return Object(p.a)({},e,{invoicesToDo:l});case"FETCH_KNACK_CUSTOMERS_FULFILLED":return Object(p.a)({},e,{customers:l});case"FETCH_ALL_INVOICES_FULFILLED":return Object(p.a)({},e,{allInvoices:l});default:return e}},N={settings:{}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"FETCH_SETTINGS_FULFILLED":return Object(p.a)({},e,{settings:l.settings});default:return e}},C=a(18),I=a(183),O=a.n(I),L=a(76),j=a(191),x=a(251),T=a.n(x),F=a(252),S=a(253),k=a(254),D=a(255),A=a.n(D),_=a(194),R=Object(L.a)(),U={key:"root",storage:T.a,whitelist:["auth"]},M=Object(j.a)(U,(n=R,Object(u.c)({auth:h,status:f,errors:E,dashboard:y,globals:w,router:Object(m.b)(n)}))),P=function(e){return function(e){return function(t){"LOGIN_FULLFILLED"===t.type?t.error||(O.a.setItem("jwt",t.payload.token),C.a.setToken(t.payload.token)):"LOGOUT"!==t.type&&"EXPIRED"!==t.type||(O.a.setItem("jwt",""),C.a.setToken(null)),e(t)}}},B=function(e){var t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.d,a=[S.a,A.a,k.a,P,Object(_.a)(R),Object(F.createStateSyncMiddleware)({blacklist:["@@router/LOCATION_CHANGE"]})],n=Object(u.e)(M,t(u.a.apply(void 0,a)));return{store:n,persistor:Object(j.b)(n)}},G=a(38),q=a(39),H=a(42),K=a(40),Z=a(41),W=a(273),V=a(257),J=a(514),Q=a(513),Y=a(12),z=a(512),X=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},$=function(){return o.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 11 21"},o.a.createElement("g",{id:"Log-In-",stroke:"none",strokeWidth:"1",fillRule:"evenodd",opacity:"0.734551711",strokeLinecap:"square"},o.a.createElement("g",{id:"Desktop-HD",transform:"translate(-580.000000, -577.000000)",stroke:"#979797"},o.a.createElement("g",{id:"arrow",transform:"translate(585.500000, 587.500000) scale(-1, -1) translate(-585.500000, -587.500000) translate(580.000000, 578.000000)"},o.a.createElement("path",{d:"M0.189655172,9.5 L11,0",id:"Line"}),o.a.createElement("path",{d:"M0.189655172,9.65322581 L10.8103448,18.8467742",id:"Line"})))))},ee=a(95),te=a.n(ee),ae=function(e){var t=e.onLogout;return o.a.createElement("header",null,o.a.createElement("div",{className:"flex flex-column flex-row-l items-center justify-around pv3 ph1 bb b--light-gray"},o.a.createElement("img",{src:te.a,width:"65px",height:"auto",alt:""}),o.a.createElement("nav",{className:"flex self-stretch"},o.a.createElement("ul",{className:"flex flex-column center mv4 mv0-l flex-row-l items-center list pa0 ma0"},o.a.createElement("li",null,o.a.createElement(z.a,{to:"/",exact:!0,className:"pa0 ma0 mh4 dinLabel gray"},"Dashboard")),o.a.createElement("li",null,o.a.createElement(z.a,{to:"/invoices/new/".concat(X()),className:"pa0 ma0 mh4 dinLabel gray dim pointer"},"Create an Invoice")),o.a.createElement("li",null,o.a.createElement(z.a,{to:"/settings",className:"pa0 ma0 mh4 dinLabel gray dim pointer"},"Settings")))),o.a.createElement("button",{onClick:t,className:"flex flex-row items-center self-center dinLabel f7 blue self-start pointer bn bg-transparent dim"},"SIGN OUT ",o.a.createElement("div",{className:"ArrowIcon mh2"},o.a.createElement($,null)))))},ne=a(15),le=a(73),oe=a(106),re=a.n(oe),se=Object(le.a)(function(e){return console.log("the state inside the selector is",e),e.dashboard.allInvoices},function(e){return e.map(function(e,t){return{isDraft:e.draft,invoiceUUID:e.id,invoiceName:e.invoiceName}})}),ie=Object(le.a)(function(e){return console.log("the state inside the selector is",e),e.dashboard.invoicesToDo},function(e){return console.log("invoices to do look like",e),re()(e,"records",[]).map(function(e,t){var a=e["".concat("field_570","_raw")][0],n=a.id,l=a.identifier;return{date:e["".concat("field_405")],customer:{id:n,name:l}}})}),ce=Object(le.a)(function(e){return console.log("the state inside the selector getCustomerSearchResults is",e),e.dashboard.customers},function(e){return re()(e,"records",[]).map(function(e,t){return{id:e.id,customerName:e.field_15}})});function me(e){var t=e.children;return o.a.createElement("button",{className:"dim pointer dinLabel f8 mid-gray tracked-mega ttu ma0 mr1 pa0 bn bg-transparent flex flex-row items-center pv1 ttu"},t,o.a.createElement("div",{className:"ArrowIcon mh2"},o.a.createElement($,null)))}var ue=a(258),pe=a.n(ue),de=a(259);function he(){return function(e,t){return C.a.setToken(t().auth.token),e({type:"FETCH_ALL_INVOICES",payload:C.a.requests.get("invoices/all").then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t.invoices}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})}}function be(){return function(e,t){var a=t().auth.token;return C.a.setToken(a),console.log("this is the current agent"),e({type:"FETCH_INVOICES_TO_DO",payload:C.a.requests.get("knack/invoices-to-do?rows_per_page=1000&sort_field=".concat("field_405","&sort_order=asc")).then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})}}var fe=a.n(de)()(function(e,t){return e({type:"FETCH_KNACK_CUSTOMERS",payload:C.a.requests.get("knack/search-customers?searchFor=".concat(t)).then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})},300);var ge=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).handleSearchChange=a.handleSearchChange.bind(Object(Y.a)(Object(Y.a)(a))),a.state={searchQuery:""},a}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchAllInvoices()}},{key:"handleSearchChange",value:function(e){this.setState(Object(ne.a)({},e.target.name,e.target.value)),this.props.fetchKnackCustomers(this.state.searchQuery)}},{key:"render",value:function(){var e=this,t=this.props;return o.a.createElement("div",{className:"flex flex-column w-100 measure-80 center pt5-l ph3 mb4"},o.a.createElement("div",{className:"flex flex-column flex-row-l w-100 items-start"},o.a.createElement("div",{className:"w-100 w-50-l"},o.a.createElement("p",{className:"dinTitle tl mid-gray pa0 mb4 ma0-l"},"Hello,",o.a.createElement("br",null),"get started now and",o.a.createElement("br",null),o.a.createElement(z.a,{to:"/invoices/new/".concat(X())},o.a.createElement("span",{className:"blue lh-title b--blue bb bw2 pointer dim"},"create an invoice.")))),o.a.createElement("div",{className:"w-100 w-50-l ba b--light-gray bw1 h5 br3 ph4 pt1 shadow-custom"},o.a.createElement("p",{className:"dinLabel tr mid-gray mb0"},"Invoices To Do (",t.invoicesToDo.length||"0",")"),o.a.createElement("div",{className:"w-100"},o.a.createElement("div",{className:"flex flex-row items-center bb b--light-gray bw1 pb1"},o.a.createElement("p",{className:"dinLabel mid-gray f7 ma0 w-25 tracked-mega ttu"},"date"),o.a.createElement("p",{className:"dinLabel mid-gray f7 ma0 w-50 tracked-mega ttu"},"customer")),o.a.createElement("ul",{className:"list ma0 pa0 overflow-scroll h4"},t.isLoading.invoicesToDo?o.a.createElement("p",null,"Loading ... "):t.isError.invoicesToDo?o.a.createElement("p",null,"There seems to be an error"):t.invoicesToDo.map(function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("div",{className:"flex flex-row items-center bb b--light-gray pv1"},o.a.createElement("p",{className:"dinLabel near-black f7 ma0 w-25 tracked-mega"},e.date),o.a.createElement("p",{className:"dinLabel near-black f7 ma0 w-50 tracked-mega small-caps"},e.customer.name||"No Name"),o.a.createElement(z.a,{to:"/invoices/new/".concat(X(),"?customer_id=").concat(e.customer.id)},o.a.createElement(me,null,"create invoice"))))}))))),o.a.createElement("div",{className:"flex flex-column flex-row-l w-100 items-start pt4"},o.a.createElement("div",{className:"w-100 pr0 w-50-l pb4 pb0-l pr4-l"},o.a.createElement("div",{className:"w-100 ba b--light-gray bw1 h6 br3 ph4 pt1 shadow-custom"},o.a.createElement("p",{className:"dinLabel tl mid-gray mb0"},"Previous Estimates (",t.allInvoices.length||"0",")"),o.a.createElement("div",{className:"w-100 mt2"},o.a.createElement("ul",{className:"list ma0 pa0 overflow-scroll h5"},t.isLoading.allInvoices?o.a.createElement("p",null,"Loading"):t.isError.allInvoices?o.a.createElement("p",null,"There seems to be an error"):t.allInvoices.length?t.allInvoices.map(function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("div",{className:"flex flex-row justify-between items-center bb b--light-gray pv1"},o.a.createElement("p",{className:"dinLabel near-black f7 ma0 w-50 tracked-mega small-caps"},e.invoiceName),o.a.createElement(z.a,{to:"/invoices/".concat(e.isDraft?"new":"pdf","/").concat(e.invoiceUUID)},o.a.createElement(me,null,e.isDraft?"cont. draft":"view pdf"))))}):o.a.createElement("p",null,"There are no invoices."))))),o.a.createElement("div",{className:"w-100 w-50-l"},o.a.createElement("div",{className:"w-100 ba b--light-gray bw1 h6 br3 ph4 pt1 shadow-custom"},o.a.createElement("div",{className:"flex flex-row items-center bt- bl-0 br-0 bb b--light-gray mt3 mb2 w-70 pv1"},o.a.createElement("span",null,o.a.createElement("img",{src:pe.a,width:"16",height:"auto"})),o.a.createElement("input",{onChange:this.handleSearchChange,className:"dinLabel pa0 ml2 tl mid-gray input-reset bn outline-0 flex-grow-1",type:"text",name:"searchQuery",placeholder:"Find a Customer",value:this.state.searchQuery})),o.a.createElement("ul",{className:"list mt2 mb0 mh0 pa0 overflow-scroll h5"},t.isLoading.customers?o.a.createElement("p",null,"Loading"):t.isError.customers?o.a.createElement("p",null,"There seems to be an error"):!t.customers.length&&e.state.searchQuery.trim()?o.a.createElement("p",null,"We could find any customers on Knack relating to your search."):t.customers.map(function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("div",{className:"flex flex-row justify-between items-center bb b--light-gray pv1"},o.a.createElement("p",{className:"dinLabel near-black f7 ma0 w-50 tracked-mega small-caps"},e.customerName),o.a.createElement(z.a,{to:"/invoices/new/".concat(X(),"?customer_id=").concat(e.id)},o.a.createElement(me,null,"create invoice"))))}))))))}}]),t}(l.Component),Ee=Object(i.c)(function(e){var t=e.status,a=e.errors,n=t.dashboard,l=a.dashboard;return{isLoading:{invoicesToDo:n.invoicesToDo,customers:n.customers,allInvoices:n.allInvoices},isError:{invoicesToDo:l.invoicesToDo,customers:l.customers,allInvoices:l.allInvoices},invoicesToDo:l.invoicesToDo&&n.invoicesToDo?[]:ie(e),customers:l.customers&&n.customers?[]:ce(e),allInvoices:l.allInvoices&&n.allInvoices?[]:se(e)}},{fetchKnackCustomers:function(e){return function(t){return fe(t,e)}},fetchInvoicesToDo:be,fetchAllInvoices:he})(ge),ve=a(272),ye=a(256),Ne=a(184),we=function(e,t,a){var n=!1;return a.forEach(function(a){JSON.stringify(e[a])!==JSON.stringify(t[a])&&(n=!0)}),n},Ce=function(){return o.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 11 13"},o.a.createElement("g",{id:"Create-Estimate",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},o.a.createElement("g",{id:"Desktop-HD",transform:"translate(-1163.000000, -578.000000)",fill:"#797979",fillRule:"nonzero"},o.a.createElement("g",{id:"room-list-item",transform:"translate(762.000000, 578.000000)"},o.a.createElement("g",{id:"delete-button",transform:"translate(351.000000, 0.000000)"},o.a.createElement("g",{id:"garbage",transform:"translate(50.000000, 0.000000)"},o.a.createElement("path",{d:"M10.7708333,1.3220339 L7.55241667,1.3220339 C7.52720833,1.04661017 7.43897917,0.582135593 7.1369375,0.284016949 C6.9458125,0.0956271186 6.70335417,0 6.4164375,0 L4.125,0 C3.83808333,0 3.595625,0.0956271186 3.4045,0.284016949 C3.10245833,0.582135593 3.01422917,1.04661017 2.98902083,1.3220339 L0.229166667,1.3220339 C0.102666667,1.3220339 0,1.42052542 0,1.54237288 C0,1.66422034 0.102666667,1.76271186 0.229166667,1.76271186 L0.696895833,1.76271186 L1.13575,11.9029322 C1.14422917,12.2823559 1.38989583,13 2.2605,13 L8.7395,13 C9.61010417,13 9.85577083,12.2823559 9.86402083,11.9075593 L10.3031042,1.76271186 L10.7708333,1.76271186 C10.8973333,1.76271186 11,1.66422034 11,1.54237288 C11,1.42052542 10.8973333,1.3220339 10.7708333,1.3220339 Z M3.73358333,0.590728814 C3.83625,0.489813559 3.96435417,0.440677966 4.125,0.440677966 L6.4164375,0.440677966 C6.57708333,0.440677966 6.7051875,0.489813559 6.80785417,0.590728814 C6.99233333,0.772067797 7.06635417,1.09111864 7.09202083,1.3220339 L3.44964583,1.3220339 C3.4753125,1.09111864 3.54933333,0.772067797 3.73358333,0.590728814 Z M9.40591667,11.893678 C9.40454167,11.9617627 9.37291667,12.559322 8.7395,12.559322 L2.2605,12.559322 C1.63395833,12.559322 1.596375,11.960661 1.59385417,11.8890508 L1.15545833,1.76271186 L9.8443125,1.76271186 L9.40591667,11.893678 Z",id:"Shape"})))))))},Ie=a(54),Oe=function(e){function t(e){return Object(G.a)(this,t),Object(H.a)(this,Object(K.a)(t).call(this,e))}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){Object.keys(this.props.room).length||this.props.history.goBack()}},{key:"render",value:function(){var e=this,t=this.props.match.params.roomId;return o.a.createElement("div",{className:"LineItems fixed top-0 left-0 w-100 z-1 vh-100 bg-black-70"},o.a.createElement("div",{className:"fixed top-0 left-0 vh-85 w-100 bg-white overflow-scroll"},o.a.createElement("div",{className:"measure-70 flex flex-column center ph2"},o.a.createElement("p",{className:"sticky top-0 dinTitle pa0 ma0 f3 mb3 ttc pt4 bg-white-70"},"line items",o.a.createElement("span",{className:"mid-gray f5 ttc db pt1"},this.props.room.name)),o.a.createElement("div",{className:"relative h-auto w-100 min-height-vh-75"},o.a.createElement("div",{className:"LineItemLabels flex flex-row items-centers ttu bb bw1 pb1 b--light-gray"},o.a.createElement("p",{className:"dinLabel f9 f7-l mid-gray w-25 pa0 ma0"},"description"),o.a.createElement("p",{className:"dinLabel f9 f7-l mid-gray w-25 pa0 ma0"},"qty"),o.a.createElement("p",{className:"dinLabel f9 f7-l mid-gray w-25 pa0 ma0"},"uom"),o.a.createElement("p",{className:"dinLabel f9 f7-l mid-gray w-25 pa0 ma0"},"labor unit"),o.a.createElement("p",{className:"dinLabel f9 f7-l mid-gray w-25 pa0 ma0"},"material unit"),o.a.createElement("p",{className:"dinLabel f9 f7-l mid-gray w-25 pa0 ma0"},"total material"),o.a.createElement("p",{className:"dinLabel f9 f7-l mid-gray w-25 pa0 ma0"},"total labor")),o.a.createElement(Ie.Accordion,null,Object.keys(this.props.room).length&&Object.keys(this.props.room.lineItems).map(function(a,n){var l=e.props.room.lineItems[a];if(void 0!==l)return o.a.createElement(Ie.AccordionItem,{key:n},o.a.createElement(Ie.AccordionItemHeading,{className:"w-100"},o.a.createElement(Ie.AccordionItemButton,{className:"relative accordion__button flex flex-row items-center ttc pv3"},o.a.createElement("p",{className:"dinLabel f7 mid-gray w-25 pa0 ma0 overflow-scroll pr2 pt2 pb3"},l.description),o.a.createElement("p",{className:"dinLabel f7 mid-gray w-25 pa0 ma0 overflow-scroll pr2 pt2 pb3"},l.quantity),o.a.createElement("p",{className:"dinLabel f7 mid-gray w-25 pa0 ma0 overflow-scroll pr2 pt2 pb3"},l.uom),o.a.createElement("p",{className:"dinLabel f7 mid-gray w-25 pa0 ma0 overflow-scroll pr2 pt2 pb3"},l.laborCost),o.a.createElement("p",{className:"dinLabel f7 mid-gray w-25 pa0 ma0 overflow-scroll pr2 pt2 pb3"},l.materialCost),o.a.createElement("p",{className:"dinLabel f7 mid-gray w-25 pa0 ma0 overflow-scroll pr2 pt2 pb3"},l.totalMaterial),o.a.createElement("p",{className:"dinLabel f7 mid-gray w-25 pa0 ma0 overflow-scroll pr2 pt2 pb3"},l.totalLabor),o.a.createElement("div",{className:"absolute right-0 h-100 items-center flex flex-row"},o.a.createElement("button",{onClick:function(){return e.props.removeLineItem(t,a)},className:"flex flex-row items-center dinLabel f7 mid-gray pointer bn bg-transparent dim ttu"},o.a.createElement("div",{className:"ArrowIcon mh1"},o.a.createElement(Ce,null))),o.a.createElement("div",{className:"ArrowIcon rotate-90 mh1"},o.a.createElement($,null))))),o.a.createElement(Ie.AccordionItemPanel,null,o.a.createElement("div",{className:"LineItem__container w-100 w-50-l pv2"},o.a.createElement("input",{className:"InputField measure-1",type:"text",name:"description",placeholder:"Enter the line-item's description",value:e.props.room.lineItems[a].description,onChange:function(n){return e.props.handleLineItemChange(n,t,a)}}),o.a.createElement("label",{htmlFor:"newLineItemDescription"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"description")),o.a.createElement("div",{className:"flex flex-row items-center flex-wrap justify-start"},o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"quantity",placeholder:"1",onBlur:function(n){return e.props.handleCostInputBlur(n,t,a)},value:e.props.room.lineItems[a].quantity,onChange:function(n){return e.props.handleLineItemChange(n,t,a)}}),o.a.createElement("label",{htmlFor:"newLineItemQuantity"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"qty"))),o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("div",{className:"relative InputField flex flex-row justify-center pointer"},o.a.createElement("p",{className:"dinLabel ttu mid-gray f7 pa0 ma0 self-center mr3"},e.props.room.lineItems[a].uom||"UOM"),o.a.createElement("div",{className:"ArrowIcon self-center rotate-90"},o.a.createElement($,null)),o.a.createElement("select",{onChange:function(n){return e.props.handleLineItemChange(n,t,a)},name:"uom",className:"absolute z-2 top-0 left-0 w-100 h-100 o-0 pointer ttc"},o.a.createElement("option",{value:"CY"},"cubic yard"),o.a.createElement("option",{value:"DA"},"day"),o.a.createElement("option",{value:"EA"},"each"),o.a.createElement("option",{value:"HR"},"hour"),o.a.createElement("option",{value:"JC"},"job cost"),o.a.createElement("option",{value:"LF"},"linear foot"),o.a.createElement("option",{value:"LS"},"lump sum"),o.a.createElement("option",{value:"MC"},"mininum change"),o.a.createElement("option",{value:"MO"},"month"),o.a.createElement("option",{value:"RM"},"room"),o.a.createElement("option",{value:"SF"},"square foot"),o.a.createElement("option",{value:"SQ"},"square"),o.a.createElement("option",{value:"SY"},"square yard"),o.a.createElement("option",{value:"TN"},"ton"),o.a.createElement("option",{value:"WK"},"week"))),o.a.createElement("label",{htmlFor:"newLineItemUOM"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttu"},"uom"))),o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("div",{className:"flex flex-row items-center"},o.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),o.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:function(n){return e.props.handleCostInputBlur(n,t,a)},className:"InputField tc",name:"laborCost",value:e.props.room.lineItems[a].laborCost,onChange:function(n){return e.props.handleLineItemChange(n,t,a)}})),o.a.createElement("label",{htmlFor:"newLineItemLaborCost"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"labor"))),o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("div",{className:"flex flex-row items-center"},o.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),o.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:function(n){return e.props.handleCostInputBlur(n,t,a)},className:"InputField tc",name:"materialCost",value:e.props.room.lineItems[a].materialCost,onChange:function(n){return e.props.handleLineItemChange(n,t,a)}})),o.a.createElement("label",{htmlFor:"newLineItemMaterialCost"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"material")))))))})),o.a.createElement("div",{className:"flex flex-column flex-row-l justify-between mt4"},o.a.createElement("div",{className:"w-100 w-50-l br bw1 b--light-gray pr4"},o.a.createElement("div",{className:"NewLineItem__container"},this.props.errors.newLineItem&&o.a.createElement("p",{className:"dinLabel red f6 o-70"}," ",this.props.errors.newLineItem," "),o.a.createElement("input",{className:"InputField measure-1",type:"text",name:"newLineItemDescription",placeholder:"Enter the line-item's description",value:this.props.newLineItemDescription,onChange:this.props.handleChange}),o.a.createElement("label",{htmlFor:"newLineItemDescription"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"description")),o.a.createElement("div",{className:"flex flex-row items-center flex-wrap justify-start"},o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"newLineItemQuantity",placeholder:"1",onChange:this.props.handleChange,value:this.props.newLineItemQuantity}),o.a.createElement("label",{htmlFor:"newLineItemQuantity"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"qty"))),o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("div",{className:"relative InputField flex flex-row justify-center pointer"},o.a.createElement("p",{className:"dinLabel ttu mid-gray f7 pa0 ma0 self-center mr3"},this.props.newLineItemUOM||"UOM"),o.a.createElement("div",{className:"ArrowIcon self-center rotate-90"},o.a.createElement($,null)),o.a.createElement("select",{onChange:this.props.handleChange,name:"newLineItemUOM",className:"absolute z-2 top-0 left-0 w-100 h-100 o-0 pointer ttc"},o.a.createElement("option",{value:"CY"},"cubic yard"),o.a.createElement("option",{value:"DA"},"day"),o.a.createElement("option",{value:"EA"},"each"),o.a.createElement("option",{value:"HR"},"hour"),o.a.createElement("option",{value:"JC"},"job cost"),o.a.createElement("option",{value:"LF"},"linear foot"),o.a.createElement("option",{value:"LS"},"lump sum"),o.a.createElement("option",{value:"MC"},"mininum change"),o.a.createElement("option",{value:"MO"},"month"),o.a.createElement("option",{value:"RM"},"room"),o.a.createElement("option",{value:"SF"},"square foot"),o.a.createElement("option",{value:"SQ"},"square"),o.a.createElement("option",{value:"SY"},"square yard"),o.a.createElement("option",{value:"TN"},"ton"),o.a.createElement("option",{value:"WK"},"week"))),o.a.createElement("label",{htmlFor:"newLineItemUOM"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttu"},"uom"))),o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("div",{className:"flex flex-row items-center"},o.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),o.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:this.props.handleCostInputBlur,className:"InputField tc",name:"newLineItemLaborCost",value:this.props.newLineItemLaborCost,onChange:this.props.handleChange})),o.a.createElement("label",{htmlFor:"newLineItemLaborCost"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"labor"))),o.a.createElement("div",{className:"w-20 flex flex-column items-center mr2"},o.a.createElement("div",{className:"flex flex-row items-center"},o.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),o.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:this.props.handleCostInputBlur,className:"InputField tc",name:"newLineItemMaterialCost",value:this.props.newLineItemMaterialCost,onChange:this.props.handleChange})),o.a.createElement("label",{htmlFor:"newLineItemMaterialCost"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"material")))),o.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",onClick:function(){return e.props.addNewLineItem(t)}},"add line item"))))),o.a.createElement("div",{className:"sticky bottom-0 dib self-center"},o.a.createElement("p",{className:"dinLabel mid-gray f6 ttu pointer",onClick:function(){return e.props.history.goBack()}},"close")))))}}]),t}(l.Component),Le=function(e){function t(e){var a;Object(G.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(Y.a)(Object(Y.a)(a))),a.addNewRoom=a.addNewRoom.bind(Object(Y.a)(Object(Y.a)(a))),a.autoSave=a.autoSave.bind(Object(Y.a)(Object(Y.a)(a))),a.addNewLineItem=a.addNewLineItem.bind(Object(Y.a)(Object(Y.a)(a))),a.handleCostInputBlur=a.handleCostInputBlur.bind(Object(Y.a)(Object(Y.a)(a))),a.calculateTotals=a.calculateTotals.bind(Object(Y.a)(Object(Y.a)(a))),a.handleLineItemChange=a.handleLineItemChange.bind(Object(Y.a)(Object(Y.a)(a))),a.handleImageChange=a.handleImageChange.bind(Object(Y.a)(Object(Y.a)(a))),a.removeRoom=a.removeRoom.bind(Object(Y.a)(Object(Y.a)(a))),a.removeLineItem=a.removeLineItem.bind(Object(Y.a)(Object(Y.a)(a))),a.sumTotals=a.sumTotals.bind(Object(Y.a)(Object(Y.a)(a))),a.removePreviewImage=a.removePreviewImage.bind(Object(Y.a)(Object(Y.a)(a))),a.removeUploadedImage=a.removeUploadedImage.bind(Object(Y.a)(Object(Y.a)(a))),a.sumRoomTotals=a.sumRoomTotals.bind(Object(Y.a)(Object(Y.a)(a))),a.uploadImage=a.uploadImage.bind(Object(Y.a)(Object(Y.a)(a))),a.generateInvoice=a.generateInvoice.bind(Object(Y.a)(Object(Y.a)(a))),a.invoiceContainerRef=Object(l.createRef)(),a.draftTimeoutId=null,a.customerKnackId="",a.whitelistedKeys=["invoiceName","customersFullName","customersAddress","customersCityState","customersZipCode","insuranceCarrier","policyNumber","claimNumber","dateOfLoss","rooms","totalLaborCost","totalMaterialCost","totalCost"];var n=X(),o=(X(),X());return a.state={invoiceName:"",insuranceCarrier:"",policyNumber:"",claimNumber:"",dateOfLoss:"2019-01-01",customersFullName:"",customersAddress:"",customersCityState:"",customersZipCode:"",newRoomName:"",newRoomLength:"",newRoomWidth:"",newRoomHeight:"8",newRoomLineItems:"",newLineItemDescription:"",newLineItemQuantity:"1",newLineItemUOM:"",newLineItemLaborCost:"0.00",newLineItemMaterialCost:"0.00",rooms:Object(ne.a)({},n,{name:"Living Room",length:"12",width:"10",height:"8",lineItems:Object(ne.a)({},o,{description:"floor",uom:"LF",materialCost:"4",laborCost:"14",totalMaterial:"",totalLabor:"",quantity:"14",total:"0.00"}),roomTotals:{totalLabor:"0",totalMaterial:"0",totalCost:"0"}}),totalLaborCost:"0",totalMaterialCost:"0",totalCost:"0",errors:{newRoom:"",newLineItem:"",roomImages:""},notUploadedImages:{},uploadedImages:{},beginAutoSave:!1,autoSaving:!1,generatingInvoice:!1},a}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"sumTotals",value:function(e,t){if(void 0!==this.state.rooms[e])return Object.keys(t).reduce(function(e,a){var n=t[a];return void 0===n||"undefined"===typeof n?e:(e.totalLabor=(parseFloat(e.totalLabor)+parseFloat(n.totalLabor)).toFixed(2),e.totalMaterial=(parseFloat(e.totalMaterial)+parseFloat(n.totalMaterial)).toFixed(2),e.totalCost=(parseFloat(e.totalCost)+parseFloat(n.total)).toFixed(2),e)},{totalLabor:"0",totalMaterial:"0",totalCost:"0"})}},{key:"sumRoomTotals",value:function(){var e=this;return Object.keys(this.state.rooms).reduce(function(t,a){var n=e.state.rooms[a];if(void 0===n)return t;var l=n.roomTotals,o=l.totalLabor,r=l.totalMaterial,s=l.totalCost;return t.totalLaborCost=(parseFloat(t.totalLaborCost)+parseFloat(o)).toFixed(2),t.totalMaterialCost=(parseFloat(t.totalMaterialCost)+parseFloat(r)).toFixed(2),t.totalCost=(parseFloat(t.totalCost)+parseFloat(s)).toFixed(2),t},{totalLaborCost:"0",totalMaterialCost:"0",totalCost:"0"})}},{key:"componentDidUpdate",value:function(e,t){t.rooms!==this.state.rooms&&this.setState(Object(p.a)({},this.sumRoomTotals())),Object.keys(this.state.notUploadedImages||{}).length>0&&this.uploadImage(),this.state.beginAutoSave&&we(t,this.state,this.whitelistedKeys)&&(console.log("component updated prevstate ===, and current state ===",Object(p.a)({},t),Object(p.a)({},this.state)),this.draftTimeoutId&&clearTimeout(this.draftTimeoutId),this.draftTimeoutId=setTimeout(this.autoSave,1250))}},{key:"componentDidMount",value:function(){var e=this,t=this.props.token;if(this.props.location.search){var a=this.props.location.search.replace(/(^\?)/,"").split("&").reduce(function(e,t){var a=t.split("="),n=Object(ve.a)(a,2),l=n[0],o=n[1];return e[l]=o,e},{});a.customer_id&&(this.customerKnackId=a.customer_id,C.a.setToken(t),C.a.requests.get("knack/search-customers/".concat(a.customer_id)).then(function(t){return 401===t.response.statusCode&&e.props.dispatch({type:"LOGOUT"}),t}).then(function(a){var n=a.response,l=n.body["".concat("field_15","_raw")],o=n.body["".concat("field_59","_raw")],r=o.city,s=o.state,i=o.zip,c=o.street,m=o.street2;return C.a.setToken(t),C.a.requests.post("invoices/".concat(e.props.match.params.draftId)).then(function(t){e.setState(Object(p.a)({},e.state,{invoiceName:t.invoiceName,customersFullName:l||"",customersAddress:"".concat(c||""," ").concat(m||""),customersCityState:r&&s?"".concat(r," , ").concat(s):"",customersZipCode:i||"",insuranceCarrier:t.claim.insuranceCarrier,policyNumber:t.claim.policyNumber,claimNumber:t.claim.claimNumber,dateOfLoss:t.claim.dateOfLoss,rooms:t.rooms||{},totalLaborCost:t.totalLaborCost,totalMaterialCost:t.totalMaterialCost,totalCost:t.totalCost,uploadedImages:t.images?t.images:{},customerKnackId:e.customerKnackId,beginAutoSave:!0}))})}).catch(function(e){console.log("error fetching customer in CreateInvoice",e)}))}else C.a.setToken(t),C.a.requests.post("invoices/".concat(this.props.match.params.draftId)).then(function(t){console.log("the customer full name is",Object(p.a)({},t.customer)),e.setState(Object(p.a)({},e.state,{invoiceName:t.invoiceName,customersFullName:t.customer.fullName,customersAddress:t.customer.address,customersCityState:t.customer.cityState,customersZipCode:t.customer.zipCode,insuranceCarrier:t.claim.insuranceCarrier,policyNumber:t.claim.policyNumber,claimNumber:t.claim.claimNumber,dateOfLoss:t.claim.dateOfLoss,rooms:t.rooms||{},totalLaborCost:t.totalLaborCost,totalMaterialCost:t.totalMaterialCost,totalCost:t.totalCost,uploadedImages:t.images?t.images:{},customerKnackId:t.customer.customerKnackId,beginAutoSave:!0}))}).catch(function(t){422===t.status&&t.response&&"NOT_DRAFT"===t.response.body.error&&e.props.history.push("/invoices/pdf/".concat(e.props.match.params.draftId)),console.log("There was an error when attempting find or create a draft invoice on CreateInvoice componentDidMount",Object(p.a)({},t))})}},{key:"componentWillUnmount",value:function(){this.draftTimeoutId&&clearTimeout(this.draftTimeoutId)}},{key:"uploadImage",value:function(){var e=this,t=Object.keys(this.state.notUploadedImages)[0],a=this.state.notUploadedImages[t].file;C.a.requests.postImage("invoices/".concat(this.props.match.params.draftId),a).then(function(a){var n=Object(p.a)({},e.state.notUploadedImages);delete n[t],e.setState(Object(p.a)({},e.state,{notUploadedImages:n,uploadedImages:a.images}))}).catch(function(e){422===e.status&&e.response&&"NOT_DRAFT"===e.response.body.error&&alert("NOT A DRAFT"),console.log("There was an error when attempting find or create a draft invoice on CreateInvoice uploadImage",Object(p.a)({},e))})}},{key:"autoSave",value:function(){var e=this,t=Object(p.a)({},this.state);this.setState({autoSaving:!0});var a=this.whitelistedKeys.reduce(function(e,a){return e[a]=t[a],e},{});console.log("the request body in autosave is",a);var n=this.props.token;C.a.setToken(n),C.a.requests.post("invoices/".concat(this.props.match.params.draftId),Object(p.a)({customerKnackId:this.state.customerKnackId},a)).then(function(t){e.setState({autoSaving:!1})}).catch(function(t){422===t.status&&t.response&&"NOT_DRAFT"===t.response.body.error&&(alert("NOT A DRAFT"),e.setState({autoSaving:!1})),console.log("There was an error when attempting find or create a draft invoice on CreateInvoice autoSave",Object(p.a)({},t))})}},{key:"handleLineItemChange",value:function(e,t,a){var n=this,l=e.target.name,o=e.target.value,r=function(e){var r,s=n.calculateTotals("quantity"===l?o.trim()||"0":e.rooms[t].lineItems[a].quantity.trim()||"0",e.rooms[t].lineItems[a].uom,"laborCost"===l?o.trim()||"0":e.rooms[t].lineItems[a].laborCost.trim()||"0","materialCost"===l?o.trim()||"0":e.rooms[t].lineItems[a].materialCost.trim()||"0"),i=s.laborTotal,c=s.materialTotal,m=s.combinedTotal;return Object(p.a)({},e.rooms[t].lineItems[a],(r={},Object(ne.a)(r,l,o),Object(ne.a)(r,"totalLabor",i),Object(ne.a)(r,"totalMaterial",c),Object(ne.a)(r,"total",m),r))}(this.state);return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},t,Object(p.a)({},this.state.rooms[t],{lineItems:Object(p.a)({},this.state.rooms[t].lineItems,Object(ne.a)({},a,r)),roomTotals:Object(p.a)({},this.state.rooms[t].roomTotals,this.sumTotals(t,Object(p.a)({},this.state.rooms[t].lineItems,Object(ne.a)({},a,r))))})))}))}},{key:"handleChange",value:function(e,t){var a=t;if(!a)return this.setState(Object(p.a)({},this.state,Object(ne.a)({},e.target.name,e.target.value)));var n=e.target.name,l=e.target.value;this.setState(function(e){return Object(p.a)({},e,{rooms:Object(p.a)({},e.rooms,Object(ne.a)({},a,Object(p.a)({},e.rooms[a],Object(ne.a)({},n,l))))})})}},{key:"handleCostInputBlur",value:function(e,t,a){var n=this;if(a&&t&&("laborCost"===e.target.name||"materialCost"===e.target.name||"quantity"===e.target.name)){return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},t,Object(p.a)({},this.state.rooms[t],{lineItems:Object(p.a)({},this.state.rooms[t].lineItems,Object(ne.a)({},a,function(l){var o,r;return n.state.rooms[t].lineItems[a][e.target.name].trim()?(r=n.calculateTotals(l.rooms[t].lineItems[a].quantity,l.rooms[t].lineItems[a].uom,l.rooms[t].lineItems[a].laborCost,l.rooms[t].lineItems[a].materialCost),Object(p.a)({},l.rooms[t].lineItems[a],{totalLabor:r.laborTotal,totalMaterial:r.materialTotal,total:r.combinedTotal})):("laborCost"===e.target.name?r=n.calculateTotals(l.rooms[t].lineItems[a].quantity,l.rooms[t].lineItems[a].uom,"0.00",l.rooms[t].lineItems[a].materialCost):"materialCost"===e.target.name?r=n.calculateTotals(l.rooms[t].lineItems[a].quantity,l.rooms[t].lineItems[a].uom,l.rooms[t].lineItems[a].laborCost,"0.00"):"quantity"===e.target.name&&(r=n.calculateTotals("0",l.rooms[t].lineItems[a].uom,l.rooms[t].lineItems[a].laborCost,l.rooms[t].lineItems[a].materialCost)),Object(p.a)({},l.rooms[t].lineItems[a],(o={},Object(ne.a)(o,e.target.name,"quantity"===e.target.name?"0":"0.00"),Object(ne.a)(o,"totalLabor",r.laborTotal),Object(ne.a)(o,"totalMaterial",r.materialTotal),Object(ne.a)(o,"total",r.combinedTotal),o)))}(this.state)))})))}))}if(("newLineItemLaborCost"===e.target.name||"newLineItemMaterialCost"===e.target.name)&&!this.state[e.target.name].trim())return this.setState(Object(ne.a)({},e.target.name,"0.00"))}},{key:"calculateTotals",value:function(e,t,a,n){var l=(parseFloat(e)*parseFloat(a)).toFixed(2),o=(parseFloat(e)*parseFloat(n)).toFixed(2);return{laborTotal:l,materialTotal:o,combinedTotal:(parseFloat(l)+parseFloat(o)).toFixed(2)}}},{key:"addNewLineItem",value:function(e){var t=this,a=this.state,n=a.newLineItemDescription,l=a.newLineItemQuantity,o=a.newLineItemUOM,r=a.newLineItemLaborCost,s=a.newLineItemMaterialCost,i=/^-?\d*(\.\d+)?$/;if(!i.test(r)||!i.test(s)||!i.test(l))return this.setState(function(e){return Object(p.a)({},e,{errors:Object(p.a)({},e.errors,{newLineItem:"Labor cost, material cost, and quantity must be a number"})})});if(!n.trim()||!(l>0)||!o.trim())return this.setState(function(e){return Object(p.a)({},e,{errors:Object(p.a)({},e.errors,{newLineItem:"You must provide a quantity greater than 0, a UOM, and a description"})})});var c=this.calculateTotals(l,o,r,s),m=c.laborTotal,u=c.materialTotal,d=c.combinedTotal,h=X(),b={description:n,uom:o,materialCost:s,laborCost:r,totalMaterial:u,totalLabor:m,quantity:l,total:d};return this.setState(function(a){return{errors:Object(p.a)({},a.errors,{newLineItem:""}),newLineItemDescription:"",newLineItemQuantity:"1",newLineItemUOM:"",newLineItemLaborCost:"0.00",newLineItemMaterialCost:"0.00",rooms:Object(p.a)({},a.rooms,Object(ne.a)({},e,Object(p.a)({},a.rooms[e],{lineItems:Object(p.a)({},a.rooms[e].lineItems,Object(ne.a)({},h,b)),roomTotals:Object(p.a)({},t.state.rooms[e].roomTotals,t.sumTotals(e,Object(p.a)({},t.state.rooms[e].lineItems,Object(ne.a)({},h,b))))})))}})}},{key:"addNewRoom",value:function(){var e=this.state,t=e.newRoomName,a=e.newRoomLength,n=e.newRoomWidth,l=e.newRoomHeight;if(!t.trim().length||!a.trim().length||!n.trim().length||!l.trim().length)return this.setState(function(e){return Object(p.a)({},e,{errors:Object(p.a)({},e.errors,{newRoom:"You must provide all fields for the new room"})})});var o=X();this.setState(function(e){return{errors:Object(p.a)({},e.errors,{newRoom:""}),newRoomName:"",newRoomLength:"",newRoomWidth:"",newRoomHeight:"8",rooms:Object(p.a)({},e.rooms,Object(ne.a)({},o,{name:t,length:a,width:n,height:l,lineItems:[],roomTotals:{totalLabor:"0",totalMaterial:"0",totalCost:"0"}}))}})}},{key:"removeRoom",value:function(e){return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},e,void 0))}))}},{key:"removeLineItem",value:function(e,t){return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},e,Object(p.a)({},this.state.rooms[e],{lineItems:Object(p.a)({},this.state.rooms[e].lineItems,Object(ne.a)({},t,void 0)),roomTotals:Object(p.a)({},this.state.rooms[e].roomTotals,this.sumTotals(e,Object(p.a)({},this.state.rooms[e].lineItems,Object(ne.a)({},t,void 0))))})))}))}},{key:"removePreviewImage",value:function(e){this.setState(Object(p.a)({},this.state,{notUploadedImages:Object(p.a)({},this.state.notUploadedImages,Object(ne.a)({},e,void 0))}))}},{key:"removeUploadedImage",value:function(e){var t=this,a=this.props.token,n=this.props.match.params.draftId;C.a.setToken(a),C.a.requests.post("invoices/".concat(n,"/remove-image/").concat(encodeURIComponent(e))).then(function(a){a.id===n&&t.setState(Object(p.a)({},t.state,{uploadedImages:Object(p.a)({},t.state.uploadedImages,Object(ne.a)({},e,void 0))}))})}},{key:"handleImageChange",value:function(e){var t=e.target.files[0];if(t){if(!["image/jpeg","image/png"].includes(t.type))return this.setState(Object(p.a)({},this.state,{errors:Object(p.a)({},this.state.errors,{roomImages:"You can only upload JPEG or PNG files"})}));var a=X(),n=URL.createObjectURL(t);this.setState(Object(p.a)({},this.state,{errors:Object(p.a)({},this.state.errors,{roomImages:""}),notUploadedImages:Object(p.a)({},this.state.notUploadedImages,Object(ne.a)({},a,{file:t,previewUrl:n}))}))}}},{key:"generateInvoice",value:function(){var e=this,t=this.props,a=t.token,n=t.history;return C.a.setToken(a),C.a.requests.post("invoices/".concat(this.props.match.params.draftId,"/generate-invoice")).then(function(t){n.push("/invoices/pdf/".concat(e.props.match.params.draftId))}).catch(function(e){console.log("There is an error in CreateInvoice in generateInvoice",e)})}},{key:"render",value:function(){var e=this;return o.a.createElement(l.Fragment,null,this.state.generatingInvoice?o.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3"},"Generating Invoice ..."):o.a.createElement("div",{ref:this.invoiceContainerRef},o.a.createElement(ye.a,{path:"".concat(this.props.match.path,"/line-items/:roomId"),render:function(t){return o.a.createElement(Oe,Object.assign({handleCostInputBlur:e.handleCostInputBlur,addNewLineItem:e.addNewLineItem,newLineItemLaborCost:e.state.newLineItemLaborCost,newLineItemMaterialCost:e.state.newLineItemMaterialCost,newLineItemUOM:e.state.newLineItemUOM,newLineItemDescription:e.state.newLineItemDescription,newLineItemQuantity:e.state.newLineItemQuantity,handleLineItemChange:e.handleLineItemChange,errors:e.state.errors,handleChange:e.handleChange,removeLineItem:e.removeLineItem,room:e.state.rooms[t.match.params.roomId]||{}},e.props,t))}}),o.a.createElement("div",{className:"flex flex-column measure-70 center ph4 pt5 mb5"},o.a.createElement("div",{className:"flex flex-column flex-row-l w100"},o.a.createElement("div",{className:"flex flex-column w-100 w-50-l pr5-l"},o.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3"},"Invoice Details"),o.a.createElement("input",{className:"InputField",type:"text",name:"invoiceName",placeholder:"Enter the invoice name here",value:this.state.invoiceName,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"invoiceName"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Invoice Name")),o.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3 mt4"},"Customer Details"),o.a.createElement("input",{className:"InputField",type:"text",name:"customersFullName",placeholder:"Enter the customer's full here",value:this.state.customersFullName,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"customersFullName"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Customers Full Name")),o.a.createElement("input",{className:"InputField",type:"text",name:"customersAddress",placeholder:"Enter the customer's address here",value:this.state.customersAddress,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"customersAddress"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Customer's Address")),o.a.createElement("input",{className:"InputField",type:"text",name:"customersCityState",placeholder:"City, State",value:this.state.customersCityState,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"customersCityState"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"City, State")),o.a.createElement("input",{className:"InputField",type:"text",name:"customersZipCode",placeholder:"Zipcode",value:this.state.customersZipCode,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"customersZipcode"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Zip Code")),o.a.createElement("p",{className:"dinTitle pa0 ma0 f4 mid-gray mb3 mt4 ttu"},"claim details"),o.a.createElement("input",{className:"InputField",type:"text",name:"insuranceCarrier",placeholder:"Enter the name of the insurance carrier",value:this.state.insuranceCarrier,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"insuranceCarrier"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Insurance Carrier")),o.a.createElement("input",{className:"InputField",type:"text",name:"policyNumber",placeholder:"Policy Number",value:this.state.policyNumber,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"policyNumber"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Policy Number")),o.a.createElement("input",{className:"InputField",type:"text",name:"claimNumber",placeholder:"Claim Number",value:this.state.claimNumber,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"claimNumber"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Claim Number")),o.a.createElement("input",{className:"InputField measure-1",type:"date",name:"dateOfLoss",value:this.state.dateOfLoss,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"dateOfLoss"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Date of Loss"))),o.a.createElement("div",{className:"flex flex-column w-100 w-50-l pl5-l"},o.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3"},"Rooms"),o.a.createElement("div",{className:"NewRoom__container"},this.state.errors.newRoom&&o.a.createElement("p",{className:"dinLabel red f6 o-70"}," ",this.state.errors.newRoom," "),o.a.createElement("input",{className:"InputField measure-1",type:"text",name:"newRoomName",placeholder:"Enter the room name",value:this.state.newRoomName,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"newRoomName"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Room Name")),o.a.createElement("div",{className:"flex flex-row items-center justify-between"},o.a.createElement("div",{className:"flex flex-row items-center justify-between w-50"},o.a.createElement("div",{className:"w-30 flex flex-column items-center"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"newRoomLength",placeholder:"0",onChange:this.handleChange,value:this.state.newRoomLength}),o.a.createElement("label",{htmlFor:"newRoomLength"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Length"))),o.a.createElement("div",{className:"w-30 flex flex-column items-center"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"newRoomWidth",placeholder:"0",onChange:this.handleChange,value:this.state.newRoomWidth}),o.a.createElement("label",{htmlFor:"newRoomWidth"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Width"))),o.a.createElement("div",{className:"w-30 flex flex-column items-center"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"newRoomHeight",placeholder:"0",value:this.state.newRoomHeight,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"newRoomHeight"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Height"))))),o.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",onClick:this.addNewRoom},"add room")),o.a.createElement("div",{className:"RoomsAccordion__container mt5"},o.a.createElement(Ie.Accordion,null,Object.keys(this.state.rooms).map(function(t,a){var n=e.state.rooms[t];if(void 0!==n)return o.a.createElement(Ie.AccordionItem,{key:a},o.a.createElement(Ie.AccordionItemHeading,{className:"w-100"},o.a.createElement(Ie.AccordionItemButton,{className:"accordion__button flex flex-row items-center justify-between"},o.a.createElement("p",{className:"tc dinLabel f7 ttu"}," ",n.name||t," "),o.a.createElement("div",{className:"flex flex-row items-center justify-between"},o.a.createElement("button",{onClick:function(){return e.removeRoom(t)},className:"flex flex-row items-center self-center dinLabel f7 mid-gray pointer bn bg-transparent dim ttu"},"delete",o.a.createElement("div",{className:"ArrowIcon mh2"},o.a.createElement(Ce,null))),o.a.createElement("div",{className:"ArrowIcon mh2"},o.a.createElement($,null))))),o.a.createElement(Ie.AccordionItemPanel,null,o.a.createElement("div",{className:"EditRoom__container pv4"},o.a.createElement("input",{className:"InputField measure-1",type:"text",name:"name",onChange:function(a){return e.handleChange(a,t)},placeholder:"Enter the room name",value:n.name}),o.a.createElement("label",{htmlFor:"newRoomName"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Room Name")),o.a.createElement("div",{className:"flex flex-row items-center justify-between"},o.a.createElement("div",{className:"flex flex-row items-center justify-between w-50"},o.a.createElement("div",{className:"w-30 flex flex-column items-center"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"length",placeholder:"0",onChange:function(a){return e.handleChange(a,t)},value:n.length}),o.a.createElement("label",{htmlFor:"newRoomLength"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Length"))),o.a.createElement("div",{className:"w-30 flex flex-column items-center"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"width",placeholder:"0",onChange:function(a){return e.handleChange(a,t)},value:n.width}),o.a.createElement("label",{htmlFor:"newRoomWidth"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Width"))),o.a.createElement("div",{className:"w-30 flex flex-column items-center"},o.a.createElement("input",{className:"InputField tc",type:"number",name:"height",placeholder:"8",onChange:function(a){return e.handleChange(a,t)},value:n.height}),o.a.createElement("label",{htmlFor:"newRoomHeight"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Height"))))),o.a.createElement(Ne.a,{to:"".concat(e.props.match.path.replace(":draftId",e.props.match.params.draftId),"/line-items/").concat(t)},o.a.createElement("div",{className:"flex flex-row items-center dinLabel f7 mid-gray self-start pointer bt-0 bl-0 br-0 bg-transparent mt2"},"ADD/EDIT LINE ITEMS")))))}))),o.a.createElement("div",{className:"mt4"},this.state.errors.roomImages&&o.a.createElement("p",{className:"dinLabel red f6 o-70"}," ",this.state.errors.roomImages," "),o.a.createElement("div",{className:"ImageUploads__container relative w-40 ba bw1 flex items-center justify-center pv2 b--light-gray br2 flex-row"},o.a.createElement("input",{type:"file",name:"roomImages",className:"absolute w-100 h-100 o-0 pointer",onChange:this.handleImageChange}),o.a.createElement("p",{className:"dinLabel pa0 ma0 f7 gray ttu dib"},"Upload an image")),o.a.createElement("div",{className:"w-100 mt3"},o.a.createElement("ul",{className:"list pa0 ma0 flex flex-row overflow-x-scroll overflow-y-hidden h100 pb2"},Object.keys(this.state.notUploadedImages).map(function(t,a){var n=e.state.notUploadedImages[t];if(void 0!==n&&"undefined"!==typeof n)return o.a.createElement("li",{key:a},o.a.createElement("div",{className:"RoomImagesContainer mr2 flex flex-column pb4"},o.a.createElement("img",{src:n.previewUrl,width:"auto",height:"270"}),o.a.createElement("button",{onClick:function(){e.removePreviewImage(t)},className:"flex flex-row items-center self-center dinLabel f7 mid-gray pointer bn bg-transparent dim ttu"},"delete",o.a.createElement("div",{className:"ArrowIcon mh2"},o.a.createElement(Ce,null)))))}),Object.keys(this.state.uploadedImages).map(function(t,a){var n=e.state.uploadedImages[t];if(void 0!==n&&"undefined"!==typeof n)return o.a.createElement("li",{key:a},o.a.createElement("div",{className:"RoomImagesContainer mr2 flex flex-column pb4"},o.a.createElement("img",{src:n.url,width:"auto",height:"270"}),o.a.createElement("button",{onClick:function(){return e.removeUploadedImage(t)},className:"flex flex-row items-center self-center dinLabel f7 mid-gray pointer bn bg-transparent dim ttu"},"delete",o.a.createElement("div",{className:"ArrowIcon mh2"},o.a.createElement(Ce,null)))))})))))),o.a.createElement("div",{className:"flex flex-column w-100 mt4"},o.a.createElement("ul",{className:"list bb b-w1 b--light-gray pa0"},Object.keys(this.state.rooms).map(function(t,a){var n=e.state.rooms[t];if(void 0!==n)return o.a.createElement("li",{className:"flex flex-column flex-row-l items-center justify-between",key:a},o.a.createElement("p",{className:"dinLabel f6 ttu"},n.name||t),o.a.createElement("div",{className:"flex flex-column flex-column-reverse flex-row-l flex-row-reverse-l"},o.a.createElement("p",{className:"dinLabel f7 pa0 mh1"},o.a.createElement("span",{className:"ttu black-60"},"total: "),"$",n.roomTotals.totalCost),o.a.createElement("p",{className:"dinLabel f7 pa0 mh1"},o.a.createElement("span",{className:"ttu black-60"},"total material: "),"$",n.roomTotals.totalMaterial),o.a.createElement("p",{className:"dinLabel f7 pa0 mh1"},o.a.createElement("span",{className:"ttu black-60"},"total labor: "),"$",n.roomTotals.totalLabor)))})),o.a.createElement("div",{className:"flex flex-column flex-row-l items-center justify-between"},o.a.createElement("ul",{className:"list pa0 tl"},o.a.createElement("li",null,o.a.createElement("p",{className:"dinLabel f6"},o.a.createElement("span",{className:"ttu black-70"},"total labor: "),"$",this.state.totalLaborCost)),o.a.createElement("li",null,o.a.createElement("p",{className:"dinLabel f6"},o.a.createElement("span",{className:"ttu black-70"},"total material: "),"$",this.state.totalMaterialCost)),o.a.createElement("li",null,o.a.createElement("p",{className:"dinLabel f6"},o.a.createElement("span",{className:"ttu black-70"},"total cost: "),"$",this.state.totalCost))),o.a.createElement("div",{className:"w-40"},o.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",disabled:this.state.autoSaving,onClick:this.generateInvoice},"generate invoice")))))))}}]),t}(l.Component),je=Object(i.c)(function(e){return{token:e.auth.token}})(Le),xe=Object(le.a)(function(e){return e.globals.settings},function(e){return{companyName:e.companyName,companyPhoneNumber:e.companyPhoneNumber,companyEmail:e.companyEmail,companyAddress:e.companyAddress,companyCityState:e.companyCityState,companyZip:e.companyZip,companyOpeningStatement:e.companyOpeningStatement}});function Te(){return function(e){return e({type:"FETCH_SETTINGS",payload:C.a.requests.get("settings").then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})}}var Fe=function(e){function t(e){var a;return Object(G.a)(this,t),a=Object(H.a)(this,Object(K.a)(t).call(this,e)),console.log("settings is",a.props.globals),a.handleChange=a.handleChange.bind(Object(Y.a)(Object(Y.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(Y.a)(Object(Y.a)(a))),a.state={companyName:"",companyPhoneNumber:"",companyEmail:"",companyAddress:"",companyCityState:"",companyZip:"",companyOpeningStatement:"",requestPending:!1},a}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.globals.settings,t=e.companyName,a=e.companyPhoneNumber,n=e.companyEmail,l=e.companyAddress,o=e.companyCityState,r=e.companyZip,s=e.companyOpeningStatement;this.setState(Object(p.a)({},this.state,{companyName:t,companyPhoneNumber:a,companyEmail:n,companyAddress:l,companyCityState:o,companyZip:r,companyOpeningStatement:s}))}},{key:"componentDidUpdate",value:function(e,t){if(we(e.globals.settings,this.props.globals.settings,Object.keys(this.state))){var a=this.props.globals.settings,n=a.companyName,l=a.companyPhoneNumber,o=a.companyEmail,r=a.companyAddress,s=a.companyCityState,i=a.companyZip,c=a.companyOpeningStatement;this.setState(Object(p.a)({},this.state,{companyName:n,companyPhoneNumber:l,companyEmail:o,companyAddress:r,companyCityState:s,companyZip:i,companyOpeningStatement:c}))}}},{key:"handleChange",value:function(e){this.setState(Object(p.a)({},this.state,Object(ne.a)({},e.target.name,e.target.value)))}},{key:"handleSubmit",value:function(){var e=this;this.setState(Object(p.a)({},this.state,{requestPending:!0}));var t=this.state,a=t.companyName,n=t.companyPhoneNumber,l=t.companyEmail,o=t.companyAddress,r=t.companyCityState,s=t.companyZip,i=t.companyOpeningStatement;C.a.setToken(this.props.token),C.a.requests.post("settings/update",{companyName:a,companyPhoneNumber:n,companyEmail:l,companyAddress:o,companyCityState:r,companyZip:s,companyOpeningStatement:i}).then(function(){return e.setState(Object(p.a)({},e.state,{requestPending:!1})),e.props.fetchSettings()}).catch(function(t){e.setState(Object(p.a)({},e.state,{requestPending:!1})),console.log("There was an error caught in handleSubmit of Settings",Object(p.a)({},t))})}},{key:"render",value:function(){return o.a.createElement("div",{className:"flex flex-column measure-70 center pt5 mb5"},o.a.createElement("div",{className:"flex flex-row w100"},o.a.createElement("div",{className:"flex flex-column w-100 ph4 w-60-l pr5"},o.a.createElement("p",{className:"dinTitle pa0 ma0 f2 mb1"},"Settings"),o.a.createElement("p",{className:"dinLabel pa0 ma0 f5 mb3 mid-gray"},"The settings below will configure the company header rendered on the ",o.a.createElement("span",{className:"ttu"},"pdf"),"s"),o.a.createElement("input",{className:"InputField",type:"text",name:"companyName",placeholder:"Enter the company name here",value:this.state.companyName,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"companyName"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Name")),o.a.createElement("input",{className:"InputField",type:"text",name:"companyPhoneNumber",placeholder:"Enter the company's phone number",value:this.state.companyPhoneNumber,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"companyPhoneNumber"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Phone Number")),o.a.createElement("input",{className:"InputField",type:"text",name:"companyEmail",placeholder:"Enter the company's email",value:this.state.companyEmail,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"companyEmail"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Email")),o.a.createElement("input",{className:"InputField",type:"text",name:"companyAddress",placeholder:"Enter the company address",value:this.state.companyAddress,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"companyAddress"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Address")),o.a.createElement("input",{className:"InputField",type:"text",name:"companyCityState",placeholder:"City, State",value:this.state.companyCityState,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"companyCityState"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"City, State")),o.a.createElement("input",{className:"InputField",type:"text",name:"companyZip",placeholder:"Zip Code",value:this.state.companyZip,onChange:this.handleChange}),o.a.createElement("label",{htmlFor:"companyZip"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Zip Code")),o.a.createElement("textarea",{className:"InputField ph4 pt2",type:"text",name:"companyOpeningStatement",placeholder:"Enter the opening statement",onChange:this.handleChange,defaultValue:"Enter the opening statement",value:this.state.companyOpeningStatement}),o.a.createElement("label",{htmlFor:"companyOpeningStatement"},o.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Opening Statement")),o.a.createElement("div",{className:"w-40"},o.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",disabled:this.props.isLoading.globals.settings||this.props.isError.globals.settings||this.state.requestPending,onClick:this.handleSubmit},"save settings")))))}}]),t}(l.Component),Se=Object(i.c)(function(e){var t=e.status,a=e.errors,n=e.auth;return{isLoading:{globals:{settings:t.globals.settings}},isError:{globals:{settings:a.globals.settings}},globals:{settings:xe(e)},token:n.token}},{fetchSettings:Te})(Fe),ke=a(6),De=ke.f.create({page:{flexDirection:"column"},headerContainer:{flexDirection:"row",padding:40,width:"100%",alignItems:"center"},smallText:{fontSize:10,paddingBottom:1}}),Ae=function(e){var t=e.companyName,a=e.companyPhoneNumber,n=e.companyEmail,l=e.companyZip,r=e.companyAddress,s=e.companyCityState,i=e.companyOpeningStatement,c=e.allRooms,m=e.allImages,u=e.fullName,p=e.address,d=e.cityState,h=e.zipCode,b=e.insuranceCarrier,f=e.policyNumber,g=e.invoiceUUID,E=e.totalCost;return o.a.createElement(ke.a,{title:"Invoice for ".concat(u," - $").concat(E)},o.a.createElement(ke.e,{size:"LETTER",style:De.page},o.a.createElement(ke.h,{style:[De.headerContainer,{justifyContent:"space-between"}],fixed:!0},o.a.createElement(ke.h,{style:{flexDirection:"row",alignItems:"center"}},o.a.createElement(ke.h,{style:{width:35}},o.a.createElement(ke.b,{src:te.a,style:{width:"100%"}})),o.a.createElement(ke.h,{style:{marginLeft:"2%"}},o.a.createElement(ke.g,{style:De.smallText},t),o.a.createElement(ke.g,{style:De.smallText},"Telephone | ".concat(a)),o.a.createElement(ke.g,{style:De.smallText},"Billing Email | ".concat(n)),o.a.createElement(ke.g,{style:De.smallText},"Mailing Address | ".concat(r," ").concat(s," ").concat(l)))),o.a.createElement(ke.b,{src:"/invoices/".concat(g,"/qr"),style:{width:30}})),o.a.createElement(ke.h,{style:{flexDirection:"column",justifyContent:"center",flexGrow:1}},o.a.createElement(ke.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},o.a.createElement(ke.g,{style:[De.smallText,{width:"30%"}]},"Customer Name"),o.a.createElement(ke.g,{style:[De.smallText,{width:"70%",flexWrap:"wrap"}]},u)),o.a.createElement(ke.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},o.a.createElement(ke.g,{style:[De.smallText,{width:"30%"}]},"Property Address"),o.a.createElement(ke.h,{style:{flexDirection:"column",width:"70%"}},o.a.createElement(ke.g,{style:De.smallText},p),o.a.createElement(ke.g,{style:De.smallText},"".concat(d," ").concat(h)))),o.a.createElement(ke.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},o.a.createElement(ke.g,{style:[De.smallText,{width:"30%"}]},"Insurance Carrier"),o.a.createElement(ke.g,{style:[De.smallText,{width:"70%",flexWrap:"wrap"}]},b)),o.a.createElement(ke.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},o.a.createElement(ke.g,{style:[De.smallText,{width:"30%"}]},"Policy Number"),o.a.createElement(ke.g,{style:[De.smallText,{width:"70%",flexWrap:"wrap"}]},f)),o.a.createElement(ke.g,{style:[De.smallText,{width:"80%",borderTop:"1 solid black",alignSelf:"center",paddingTop:10}]},i)),o.a.createElement(ke.h,{style:{flexDirection:"column",width:"90%",alignSelf:"center",minHeight:500},break:!0},c.map(function(e){return o.a.createElement(ke.h,{style:{flexDirection:"column",width:"100%",marginBottom:30}},o.a.createElement(ke.h,{style:{flexDirection:"row",justifyContent:"space-between",borderBottom:"1 solid black",paddingBottom:5,marginBottom:8}},o.a.createElement(ke.g,{style:De.smallText},e.name),o.a.createElement(ke.g,{style:De.smallText},"L: ".concat(e.length," | W: ").concat(e.width," | H: ").concat(e.height))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Square Footage of Floor"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.SFFloor," sq. ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Square Footage of Ceiling"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.SFCeiling," sq. ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Square Footage of Walls"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.SFWalls," sq. ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Square Footage of Walls & Ceiling"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.SFWallsCeiling," sq. ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Square Footage of Walls, Floor & Ceiling"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.SFWallsFloorCeiling," sq. ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Linear Footage of Floor Perimeter"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.LFFloorPerim," ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Linear Footage of Ceiling Perimeter"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.LFCeilingPerim," ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Linear Footage of Floor & Ceiling Perimeter"),o.a.createElement(ke.g,{style:De.smallText},"".concat(e.LFFloorCeilingPerim," ft."))),o.a.createElement(ke.h,{style:{flexDirection:"row",justifyContent:"center",borderBottom:"1 solid gray",paddingBottom:5,marginTop:10,marginBottom:5}},o.a.createElement(ke.g,{style:[De.smallText,{width:"20%"}]},"Qty"),o.a.createElement(ke.g,{style:[De.smallText,{width:"50%"}]},"Description"),o.a.createElement(ke.g,{style:[De.smallText,{width:"10%"}]},"Labor Cost"),o.a.createElement(ke.g,{style:[De.smallText,{width:"10%"}]},"Unit Cost"),o.a.createElement(ke.g,{style:[De.smallText,{width:"10%",textAlign:"right"}]},"Total")),e.lineItems.map(function(e){return o.a.createElement(ke.h,{style:{flexDirection:"row",justifyContent:"center",paddingBottom:10}},o.a.createElement(ke.g,{style:[De.smallText,{width:"20%"}]},"".concat(e.quantity," ").concat(e.uom)),o.a.createElement(ke.g,{style:[De.smallText,{width:"50%",flexWrap:"wrap",paddingRight:1}]},e.description),o.a.createElement(ke.g,{style:[De.smallText,{width:"10%"}]},"$",e.laborCost),o.a.createElement(ke.g,{style:[De.smallText,{width:"10%"}]},"$",e.materialCost),o.a.createElement(ke.g,{style:[De.smallText,{width:"10%",textAlign:"right"}]},"$",e.total))}),o.a.createElement(ke.h,{style:{flexDirection:"row",justifyContent:"space-between",borderBottom:"1 solid black",paddingBottom:5,marginBottom:5}},o.a.createElement(ke.g,{style:De.smallText},"Totals - ".concat(e.name)),o.a.createElement(ke.g,{style:De.smallText},"Labor Totals: $".concat(e.roomTotals.totalLabor," | Unit Totals: $").concat(e.roomTotals.totalMaterial," | Totals: $").concat(e.roomTotals.totalCost))))})),o.a.createElement(ke.h,{style:{flexDirection:"column",width:"90%",alignSelf:"center"},break:!0},o.a.createElement(ke.g,{style:[De.smallText,{marginBottom:10}],fixed:!0},m.length>0&&"Images"),o.a.createElement(ke.h,{style:{flexDirection:"row",width:"100%",alignSelf:"center",flexWrap:"wrap"},break:!0},m.map(function(e){return o.a.createElement(ke.b,{src:e,style:{width:"40%",marginRight:10,marginBottom:10}})}))),o.a.createElement(ke.h,{style:{flexDirection:"column",width:"90%",alignSelf:"center",minHeight:500},break:!0},o.a.createElement(ke.g,{style:[De.smallText,{textAlign:"right",textDecoration:"underline"}]},"Totals"),c.map(function(e){return o.a.createElement(ke.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},e.name),o.a.createElement(ke.g,{style:De.smallText},"$",e.roomTotals.totalCost))}),o.a.createElement(ke.h,{style:{flexDirection:"row",marginTop:20,justifyContent:"space-between"}},o.a.createElement(ke.g,{style:[De.smallText,{marginRight:20}]},"Total Amount"),o.a.createElement(ke.g,{style:De.smallText},"$",E))),o.a.createElement(ke.h,{style:{flexDirection:"column",width:"80%",position:"absolute",bottom:0,borderTop:"1 solid gray",paddingVertical:10,marginBottom:10,alignSelf:"center"},fixed:!0},o.a.createElement(ke.g,{style:[De.smallText,{color:"gray",textAlign:"center"}],render:function(e){e.pageNumber,e.totalPages;return"Invoice for ".concat(u," - Invoice ID : ").concat(g)}}))))},_e=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).state={invoice:null},a}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("the invoiceid is",this.props.match.params),C.a.setToken(this.props.token),C.a.requests.get("invoices/".concat(this.props.match.params.invoiceId)).then(function(t){var a=t.invoice;e.setState({invoice:a})}).catch(function(t){404===t.status&&(e.props.history.push("/"),e.setState({invoice:null}))})}},{key:"render",value:function(){var e=this.props.globals.settings,t=(e.companyName,e.companyPhoneNumber,[]),a=[],n={},l={},r="",s="";if(this.state.invoice){var i=Object.keys(this.state.invoice.rooms||{}),c=this.state.invoice.rooms;t=i.map(function(e){var t=c[e],a=Object.keys(t.lineItems),n=t.lineItems,l=a.map(function(e){return n[e]}),o=function(e,t,a){var n,l,o,r,s;return{SFFloor:n=e*t,SFCeiling:l=e*t,SFWalls:o=2*(e*a+t*a),SFWallsCeiling:o+l,SFWallsFloorCeiling:o+n+l,LFFloorPerim:r=2*e+2*t,LFCeilingPerim:s=2*e+2*t,LFFloorCeilingPerim:r+s}}(t.length,t.width,t.height);return Object(p.a)({},o,t,{lineItems:l})});var m=Object.keys(this.state.invoice.images||{}),u=this.state.invoice.images;a=m.map(function(e){return u[e].url}),n=this.state.invoice.customer,l=this.state.invoice.claim,r=this.state.invoice.id,s=this.state.invoice.totalCost}return o.a.createElement("div",{className:"flex flex-column justify-center pv4"},o.a.createElement(ke.c,{document:o.a.createElement(Ae,Object.assign({},this.props.globals.settings,{allRooms:t||[],allImages:a},n,l,{invoiceUUID:r,totalCost:s})),fileName:X(),className:"dinTitle f4 mid-gray center mv4",key:X()},function(e){e.blob,e.url;var t=e.loading;e.error;return t?"Loading document...":"Download PDF"}),o.a.createElement(ke.d,{height:"800px",className:"center w-90 w-60-l",key:X()},o.a.createElement(Ae,Object.assign({},this.props.globals.settings,{allRooms:t||[],allImages:a},n,l,{invoiceUUID:r,totalCost:s}))))}}]),t}(l.Component),Re=Object(i.c)(function(e){var t=e.status,a=e.errors,n=e.auth;return{isLoading:{globals:{settings:t.globals.settings}},isError:{globals:{settings:a.globals.settings}},globals:{settings:xe(e)},token:n.token}},{fetchSettings:Te})(_e),Ue=function(e){return o.a.createElement("div",null,"Not Found ")},Me=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).logout=a.logout.bind(Object(Y.a)(Object(Y.a)(a))),a}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"componentDidMount",value:function(){this.props.initApp()}},{key:"logout",value:function(){this.props.logout()}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(ae,{onLogout:this.logout}),o.a.createElement("main",null,o.a.createElement(Q.a,null,o.a.createElement(V.a,{exact:!0,path:this.props.match.path,component:Ee}),o.a.createElement(V.a,{path:this.props.match.path+"invoices/new/:draftId",component:je}),o.a.createElement(V.a,{path:"".concat(this.props.match.path,"settings"),component:Se}),o.a.createElement(V.a,{path:"".concat(this.props.match.path,"invoices/pdf/:invoiceId"),exact:!0,component:Re}),o.a.createElement(V.a,{path:"/*",component:Ue}))))}}]),t}(l.Component),Pe=Object(i.c)(null,{logout:function(){return{type:"LOGOUT"}},initApp:function(){return function(e){return e({type:"INIT_APP",payload:new Promise(function(t,a){var n=Promise.all([e(be()),e(he()),e(Te())]),l=new Promise(function(e,t){setTimeout(function(){return t("Timeout")},1e4)});return Promise.race([n,l]).then(function(){return t()}).catch(function(e){return a(e)})})})}}})(Me),Be=a(36),Ge=function(e){function t(e){var a;return Object(G.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).login=a.login.bind(Object(Y.a)(Object(Y.a)(a))),a.handleChange=a.handleChange.bind(Object(Y.a)(Object(Y.a)(a))),a.state={email:"",password:""},a}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(ne.a)({},e.target.name,e.target.value))}},{key:"componentDidMount",value:function(){var e=this.props.location.state;this.props.isAuth&&(e?this.props.push(this.props.location.state.from):this.props.push("/"))}},{key:"login",value:function(){this.props.attemptLogin(this.state.email,this.state.password).catch(function(e){if(401===e.response.statusCode||403===e.response.statusCode)return alert("Your email or password is incorrect"),void console.log("this is the error -----\x3e",e);alert("there was an error"),console.log("this is the error -----\x3e",e)})}},{key:"componentDidUpdate",value:function(){var e=this.props.location.state;this.props.isAuth&&(e?this.props.push(this.props.location.state.from):this.props.push("/"))}},{key:"render",value:function(){return o.a.createElement("div",{className:"w-100 vh-100 flex flex-column ph2 justify-center flex-row-l items-center measure-1024 center"},o.a.createElement("div",{className:"fl w-90 w-50-l flex flex-column items-center"},o.a.createElement("p",{className:"self-start dinTitle"},"Welcome back,",o.a.createElement("br",null),"Sign in.",o.a.createElement("span",{className:"db mt3"},o.a.createElement("img",{src:te.a,width:"25%",height:"auto",alt:""})))),o.a.createElement("div",{className:"fl w-90 w-50-l flex flex-column items-center"},o.a.createElement("div",{className:"self-start w-100 measure ph3"},o.a.createElement("input",{className:"InputField",type:"email",name:"email",value:this.state.email,placeholder:"Knack Email",onChange:this.handleChange}),o.a.createElement("input",{className:"InputField",type:"password",name:"password",value:this.state.password,placeholder:"Knack Password",onChange:this.handleChange}),o.a.createElement("button",{className:"flex flex-row items-center dinLabel f7 blue self-start pointer bn bg-transparent mt3",onClick:this.login,disabled:this.props.loading},"SIGN IN ",o.a.createElement("div",{className:"ArrowIcon mh2"},o.a.createElement($,null))))))}}]),t}(l.Component),qe=Object(i.c)(function(e){return{isAuth:e.auth.isAuth,loading:e.status.authLoading}},{push:Be.d,test:function(){return{type:"CHANGE"}},attemptLogin:function(e,t){return function(a){return a({type:"LOGIN",payload:C.a.Auth.login(e,t).then(function(e){return e.isAuth?e:Promise.reject(e)})})}}})(Ge),He=(a(509),Object(i.c)(function(e){return{isAuth:e.auth.isAuth}},null)(function(e){var t=e.component,a=e.isAuth,n=Object(W.a)(e,["component","isAuth"]);return o.a.createElement(V.a,Object.assign({},n,{render:function(e){return a?o.a.createElement(t,e):o.a.createElement(J.a,{to:{pathname:"/login",state:{from:e.location}}})}}))})),Ke=function(e){function t(){return Object(G.a)(this,t),Object(H.a)(this,Object(K.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(q.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(Q.a,null,o.a.createElement(V.a,{path:"/login",exact:!0,component:qe}),o.a.createElement(He,{path:"/",component:Pe})))}}]),t}(l.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ze=B(),We=Ze.store,Ve=Ze.persistor;s.a.render(o.a.createElement(i.a,{store:We},o.a.createElement(c.a,{loading:null,persistor:Ve},o.a.createElement(m.a,{history:R},o.a.createElement(Ke,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},95:function(e,t,a){e.exports=a.p+"static/media/small_logo.f373b7af.png"}},[[274,1,2]]]);
//# sourceMappingURL=main.a0abceb1.chunk.js.map