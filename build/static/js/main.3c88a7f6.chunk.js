(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,a){e.exports=a.p+"static/media/small_logo.f373b7af.png"},16:function(e,t,a){"use strict";(function(e){var n=a(266),l=a.n(n),r=a(267),o=a.n(r),s=l()(o.a,e.Promise),i=function(e){return e.body},c=null,m=function(e){console.log("the token object right now!",c),c&&e.set("authorization","".concat(c))},u={del:function(e){return s.del("".concat("/").concat(e)).use(m).then(i)},get:function(e){return s.get("".concat("/").concat(e)).use(m).then(i)},put:function(e,t){return s.put("".concat("/").concat(e),t).use(m).then(i)},post:function(e,t){return s.post("".concat("/").concat(e),t).use(m).then(i)},postImage:function(e,t){return s.post("".concat("/").concat(e)).use(m).attach("invoiceImages",t).then(i)}};t.a={Auth:{login:function(e,t){return u.post("users/login",{email:e,password:t})}},requests:u,setToken:function(e){c=e}}}).call(this,a(37))},275:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAs1JREFUSA21lslqVUEQQI2zOE/BGRKNRAUnHJaiXyAiguJGshLc+CWCoIv8QMSV/kJUVHBYGKMLpyQqUeMAznE8J6Sf9frdvJsXTMHhVldX3+quqtvvNU0pl+W4rIVm2Aq98AoGYBAakqY63tuY2wdtMLvAbxjbE+iGO/ALSqUo4CJWHYHdpav/OfSgXgBPXlemZbMrGZ+C9sxeNjTdZsQTv6/nHE/oyU7DqmzBc8Z3oQ8+g+m1ptuhFaK8Y3AGBqMx6ingVIwdsCdMfke/BFdAPZfpGPbCYZgXJh+in4UfwVZRU0q3YDkEaQPf0DvhBozVDL+ZG4BHYDpngbIMXoNzNeLJDLJ/9JkcPNm9NCh5Pma+C/4EP99nBmrEgEtgY5hxZ91hPB71Nk6mMsk6lNVpEJ8GdNJGSHILpTD/yaHgaXpvBrvvbQnjiuqEN0mUZ3HQgN6Pb6y3n0qNGDB+4NbhU43X+AxfcfsZXGPWKmYDxtzbQKnbKk7jVGbgl7reJYVlMeALZ4N420xEVrAodmbhjWNAb5KY+x0TicaafF1f0XsM6DUUP9JNjDcXOdex2ek7w/wQ+pgBLfTV4GwdjsHSYKunzmfyOMTaX2P8pWhRKrI/K15vXuCKd6MndZcfYCyx3h2wPjhYnstQWMMU0FPaPLsgFX4Bupe5m/Dy9gfXLp4Da+AAHIW8ySxTC/SCvy5V4guiGPAEzIzGUf0jTy9159xMvhZTlbxkdA68yCuSTpgMOvWDKZqbjKNPa6TNDzoP5oWR26xtO9yHSj3zgMyN7MjL2Bc0Q2wGhlXii67DRdA3bzQzURU03xXzVbKYkc3TCv7OGdwb5C08hQfwBpSFcBLMTi5+66Z3qCxgvrBsbIMZ1A3mMoChsyiluWMjY5uqBzaA2YliBob/d0ADpKBt6DGoN1rXZATMg5pmg52HVG99JkXs2oPg35gR+QtuoXwKGm7ejAAAAABJRU5ErkJggg=="},299:function(e,t,a){e.exports=a(535)},316:function(e,t){},371:function(e,t){},373:function(e,t){},412:function(e,t){},413:function(e,t){},534:function(e,t,a){},535:function(e,t,a){"use strict";a.r(t);var n,l=a(1),r=a.n(l),o=a(150),s=a.n(o),i=a(36),c=a(265),m=a(103),u=a(55),p=a(4),d={isAuth:!1,token:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"LOGIN".concat("_FULFILLED"):return Object(p.a)({},e,{token:l.token,isAuth:l.isAuth});case"LOGOUT":case"LOGIN".concat("_REJECTED"):return Object(p.a)({},e,{token:null,isAuth:!1});case"CHANGE":return Object(p.a)({},e,{isAuth:!0});default:return e}},b={authLoading:!1,dashboard:{invoicesToDo:!1,customers:!1,allInvoices:!1},globals:{settings:!1}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0,a=t.type;t.payload;switch(a){case"LOGIN".concat("_FULFILLED"):return Object(p.a)({},e,{authLoading:!1});case"LOGIN".concat("_PENDING"):return Object(p.a)({},e,{authLoading:!0});case"LOGOUT":case"LOGIN".concat("_REJECTED"):return Object(p.a)({},e,{authLoading:!1});case"FETCH_SETTINGS_PENDING":return Object(p.a)({},e,{globals:Object(p.a)({},e.globals,{settings:!0})});case"FETCH_SETTINGS_FULFILLED":case"FETCH_SETTINGS_REJECTED":return Object(p.a)({},e,{globals:Object(p.a)({},e.globals,{settings:!1})});case"FETCH_ALL_INVOICES_PENDING":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:!0})});case"FETCH_ALL_INVOICES_FULFILLED":case"FETCH_ALL_INVOICES_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:!1})});case"FETCH_INVOICES_TO_DO_PENDING":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:!0})});case"FETCH_INVOICES_TO_DO_FULFILLED":case"FETCH_INVOICES_TO_DO_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:!1})});case"FETCH_KNACK_CUSTOMERS_PENDING":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:!0})});case"FETCH_KNACK_CUSTOMERS_FULFILLED":case"FETCH_KNACK_CUSTOMERS_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:!1})});default:return e}},f={dashboard:{invoicesToDo:null,customers:null,allInvoices:null},globals:{settings:null}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"FETCH_SETTINGS_PENDING":case"FETCH_SETTINGS_FULFILLED":return Object(p.a)({},e,{globals:{settings:null}});case"FETCH_SETTINGS_REJECTED":return Object(p.a)({},e,{globals:{settings:l}});case"FETCH_ALL_INVOICES_PENDING":case"FETCH_ALL_INVOICES_FULFILLED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:null})});case"FETCH_ALL_INVOICES_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{allInvoices:l})});case"FETCH_INVOICES_TO_DO_PENDING":case"FETCH_INVOICES_TO_DO_FULFILLED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:null})});case"FETCH_INVOICES_TO_DO_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{invoicesToDo:l})});case"FETCH_KNACK_CUSTOMERS_PENDING":case"FETCH_KNACK_CUSTOMERS_FULFILLED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:null})});case"FETCH_KNACK_CUSTOMERS_REJECTED":return Object(p.a)({},e,{dashboard:Object(p.a)({},e.dashboard,{customers:l})});default:return e}},v={invoicesToDo:{},customers:{},allInvoices:[]},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"FETCH_INVOICES_TO_DO_FULFILLED":return Object(p.a)({},e,{invoicesToDo:l});case"FETCH_KNACK_CUSTOMERS_FULFILLED":return Object(p.a)({},e,{customers:l});case"FETCH_ALL_INVOICES_FULFILLED":return Object(p.a)({},e,{allInvoices:l});default:return e}},C={settings:{}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,l=void 0===n?{}:n;switch(a){case"FETCH_SETTINGS_FULFILLED":return Object(p.a)({},e,{settings:l.settings});default:return e}},I=a(16),w=a(200),O=a.n(w),L=a(83),T=a(208),j=a(268),x=a.n(j),S=a(269),F=a(270),k=a(271),D=a(272),A=a.n(D),_=a(212),R=Object(L.a)(),U={key:"root",storage:x.a,whitelist:["auth"]},M=Object(T.a)(U,(n=R,Object(u.c)({auth:h,status:g,errors:E,dashboard:y,globals:N,router:Object(m.b)(n)}))),P=function(e){return function(e){return function(t){"LOGIN_FULLFILLED"===t.type?t.error||(O.a.setItem("jwt",t.payload.token),I.a.setToken(t.payload.token)):"LOGOUT"!==t.type&&"EXPIRED"!==t.type||(O.a.setItem("jwt",""),I.a.setToken(null)),e(t)}}},B=function(e){var t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.d,a=[F.a,A.a,k.a,P,Object(_.a)(R),Object(S.createStateSyncMiddleware)({blacklist:["@@router/LOCATION_CHANGE"]})],n=Object(u.e)(M,t(u.a.apply(void 0,a)));return{store:n,persistor:Object(T.b)(n)}},q=a(40),G=a(41),H=a(44),K=a(42),W=a(43),V=a(290),Z=a(274),Q=a(557),J=a(555),Y=a(12),z=a(549),X=function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)},$=function(){return r.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 11 21"},r.a.createElement("g",{id:"Log-In-",stroke:"none",strokeWidth:"1",fillRule:"evenodd",opacity:"0.734551711",strokeLinecap:"square"},r.a.createElement("g",{id:"Desktop-HD",transform:"translate(-580.000000, -577.000000)",stroke:"#979797"},r.a.createElement("g",{id:"arrow",transform:"translate(585.500000, 587.500000) scale(-1, -1) translate(-585.500000, -587.500000) translate(580.000000, 578.000000)"},r.a.createElement("path",{d:"M0.189655172,9.5 L11,0",id:"Line"}),r.a.createElement("path",{d:"M0.189655172,9.65322581 L10.8103448,18.8467742",id:"Line"})))))},ee=a(104),te=a.n(ee),ae=function(e){var t=e.onLogout;return r.a.createElement("header",null,r.a.createElement("div",{className:"flex flex-column flex-row-l items-center justify-around pv3 ph1 bb b--light-gray"},r.a.createElement(z.a,{to:"/"},r.a.createElement("img",{src:te.a,width:"65px",height:"auto",alt:""})),r.a.createElement("nav",{className:"flex self-stretch"},r.a.createElement("ul",{className:"flex flex-column center mv4 mv0-l flex-row-l items-center list pa0 ma0"},r.a.createElement("li",null,r.a.createElement(z.a,{to:"/",exact:!0,className:"pa0 ma0 mh4 dinLabel gray"},"Dashboard")),r.a.createElement("li",null,r.a.createElement(z.a,{to:"/invoices/new/".concat(X()),className:"pa0 ma0 mh4 dinLabel gray dim pointer"},"Create an Invoice")),r.a.createElement("li",null,r.a.createElement(z.a,{to:"/settings",className:"pa0 ma0 mh4 dinLabel gray dim pointer"},"Settings")))),r.a.createElement("button",{onClick:t,className:"flex flex-row items-center self-center dinLabel f7 blue self-start pointer bn bg-transparent dim"},"SIGN OUT ",r.a.createElement("div",{className:"ArrowIcon mh2"},r.a.createElement($,null)))))},ne=a(18),le=a(78),re=a(116),oe=a.n(re),se=Object(le.a)(function(e){return console.log("the state inside the selector is",e),e.dashboard.allInvoices},function(e){return e.map(function(e,t){return{isDraft:e.draft,invoiceUUID:e.id,invoiceName:e.invoiceName}})}),ie=Object(le.a)(function(e){return console.log("the state inside the selector is",e),e.dashboard.invoicesToDo},function(e){return console.log("invoices to do look like",e),oe()(e,"records",[]).map(function(e,t){var a=e["".concat("field_565","_raw")][0],n=a.id,l=a.identifier;return{date:e["".concat("field_405")],customer:{id:n,name:l}}})}),ce=Object(le.a)(function(e){return console.log("the state inside the selector getCustomerSearchResults is",e),e.dashboard.customers},function(e){return oe()(e,"records",[]).map(function(e,t){return{id:e.id,customerName:e.field_15}})});function me(e){var t=e.children;return r.a.createElement("button",{className:"dim pointer dinLabel f8 mid-gray tracked-mega ttu ma0 mr1 pa0 bn bg-transparent flex flex-row items-center pv1 ttu"},t,r.a.createElement("div",{className:"ArrowIcon mh2"},r.a.createElement($,null)))}var ue=a(275),pe=a.n(ue),de=a(276);function he(){return function(e,t){return I.a.setToken(t().auth.token),e({type:"FETCH_ALL_INVOICES",payload:I.a.requests.get("invoices/all").then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t.invoices}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})}}function be(){return function(e,t){var a=t().auth.token;return I.a.setToken(a),console.log("this is the current agent"),e({type:"FETCH_INVOICES_TO_DO",payload:I.a.requests.get("knack/invoices-to-do?rows_per_page=1000&sort_field=".concat("field_405","&sort_order=asc")).then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})}}var ge=a.n(de)()(function(e,t){return e({type:"FETCH_KNACK_CUSTOMERS",payload:I.a.requests.get("knack/search-customers?searchFor=".concat(t)).then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})},300);var fe=a(48),Ee=a(551),ve=a(554),ye=a(558),Ce=a(552),Ne=a(553),Ie=a(550),we=function(e){function t(e){var a;return Object(q.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).handleSearchChange=a.handleSearchChange.bind(Object(Y.a)(Object(Y.a)(a))),a.state={searchQuery:""},a}return Object(W.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchAllInvoices()}},{key:"handleSearchChange",value:function(e){this.setState(Object(ne.a)({},e.target.name,e.target.value)),this.props.fetchKnackCustomers(this.state.searchQuery)}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes;return r.a.createElement("div",{className:"flex flex-column w-100 measure-80 center pt5-l ph3 mb4"},r.a.createElement("div",{className:"flex flex-column flex-row-l w-100 items-start"},r.a.createElement("div",{className:"w-100 w-50-l"},r.a.createElement("p",{className:"dinTitle tl mid-gray pa0 mb4 ma0-l"},"Hello,",r.a.createElement("br",null),"get started now and",r.a.createElement("br",null),r.a.createElement(z.a,{to:"/invoices/new/".concat(X())},r.a.createElement("span",{className:"blue lh-title b--blue bb bw2 pointer dim"},"create an invoice.")))),r.a.createElement("div",{className:"w-100 w-50-l ba b--light-gray bw1 h-auto br3 pt1 shadow-custom overflow-hidden"},r.a.createElement("p",{className:"dinLabel tr mid-gray mb0 ph3"},"Invoices To Do (",t.invoicesToDo.length||"0",")"),r.a.createElement("div",{className:"w-100 flex-grow-1 mt2"},t.isLoading.invoicesToDo?r.a.createElement("p",{className:"tc"},"Loading ... "):t.isError.invoicesToDo?r.a.createElement("p",null,"There seems to be an error"):r.a.createElement(Ie.a,{className:a.root},r.a.createElement(Ee.a,{className:a.table},r.a.createElement(Ce.a,null,r.a.createElement(Ne.a,null,r.a.createElement(ye.a,{align:"left"},"Date"),r.a.createElement(ye.a,{align:"left"},"Customer"),r.a.createElement(ye.a,{align:"left"},"Action"))),r.a.createElement(ve.a,null,t.invoicesToDo.map(function(e,t){return r.a.createElement(Ne.a,{key:t},r.a.createElement(ye.a,{align:"left"},e.date),r.a.createElement(ye.a,{align:"left"},e.customer.name||"No Name"),r.a.createElement(ye.a,{align:"left"},r.a.createElement(z.a,{to:"/invoices/new/".concat(X(),"?customer_id=").concat(e.customer.id)},r.a.createElement(me,null,"create invoice"))))}))))))),r.a.createElement("div",{className:"flex flex-column flex-row-l w-100 items-start pt4"},r.a.createElement("div",{className:"w-100 pr0 w-50-l pb4 pb0-l pr4-l"},r.a.createElement("div",{className:"w-100 ba b--light-gray bw1 br3 pt1 shadow-custom overflow-hidden"},r.a.createElement("p",{className:"dinLabel tl mid-gray mb0 ph4"},"Previous Invoices (",t.allInvoices.length||"0",")"),r.a.createElement("div",{className:"w-100 flex-grow-1 mt2"},t.isLoading.allInvoices?r.a.createElement("p",{className:"tc"},"Loading"):t.isError.allInvoices?r.a.createElement("p",null,"There seems to be an error"):t.allInvoices.length?r.a.createElement(Ie.a,{className:a.root,style:{height:"20rem"}},r.a.createElement(Ee.a,{className:a.table},r.a.createElement(Ce.a,null,r.a.createElement(Ne.a,null,r.a.createElement(ye.a,{align:"left"},"Invoice Name"),r.a.createElement(ye.a,{align:"left"},"Action"),r.a.createElement(ye.a,{align:"left"},"Delete Draft"))),r.a.createElement(ve.a,null,t.allInvoices.map(function(t,a){return r.a.createElement(Ne.a,{key:a},r.a.createElement(ye.a,{align:"left"},t.invoiceName),r.a.createElement(ye.a,{align:"left"},r.a.createElement(z.a,{to:"/invoices/".concat(t.isDraft?"new":"pdf","/").concat(t.invoiceUUID)},r.a.createElement(me,null,t.isDraft?"cont. draft":"view pdf"))),r.a.createElement(ye.a,{align:"left"},r.a.createElement("button",{onClick:function(){e.props.deleteDraftInvoice(t.invoiceUUID)},disabled:!t.isDraft,className:"db mt1 dinTitle f8 mid-gray ba b--red tracked ttu tc pa2 br2 red ".concat(t.isDraft?"dim pointer":"o-10")},"delete")))})))):r.a.createElement("p",null,"There are no invoices.")))),r.a.createElement("div",{className:"w-100 w-50-l"},r.a.createElement("div",{className:"w-100 ba b--light-gray bw1 h6 br3 ph4 pt1 shadow-custom"},r.a.createElement("div",{className:"flex flex-row items-center bt- bl-0 br-0 bb b--light-gray mt3 mb2 w-70 pv1"},r.a.createElement("span",null,r.a.createElement("img",{src:pe.a,width:"16",height:"auto"})),r.a.createElement("input",{onChange:this.handleSearchChange,className:"dinLabel pa0 ml2 tl mid-gray input-reset bn outline-0 flex-grow-1",type:"text",name:"searchQuery",placeholder:"Find a Customer",value:this.state.searchQuery})),r.a.createElement("ul",{className:"list mt2 mb0 mh0 pa0 overflow-scroll h5"},t.isLoading.customers?r.a.createElement("p",{className:"tc"},"Loading"):t.isError.customers?r.a.createElement("p",null,"There seems to be an error"):!t.customers.length&&e.state.searchQuery.trim()?r.a.createElement("p",null,"We could find any customers on Knack relating to your search."):t.customers.map(function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("div",{className:"flex flex-row justify-between items-center bb b--light-gray pv1"},r.a.createElement("p",{className:"dinLabel near-black f7 ma0 w-50 tracked-mega small-caps"},e.customerName),r.a.createElement(z.a,{to:"/invoices/new/".concat(X(),"?customer_id=").concat(e.id)},r.a.createElement(me,null,"create invoice"))))}))))))}}]),t}(l.Component),Oe=Object(i.c)(function(e){var t=e.status,a=e.errors,n=t.dashboard,l=a.dashboard;return{isLoading:{invoicesToDo:n.invoicesToDo,customers:n.customers,allInvoices:n.allInvoices},isError:{invoicesToDo:l.invoicesToDo,customers:l.customers,allInvoices:l.allInvoices},invoicesToDo:l.invoicesToDo&&n.invoicesToDo?[]:ie(e),customers:l.customers&&n.customers?[]:ce(e),allInvoices:l.allInvoices&&n.allInvoices?[]:se(e)}},{fetchKnackCustomers:function(e){return function(t){return ge(t,e)}},fetchInvoicesToDo:be,fetchAllInvoices:he,deleteDraftInvoice:function(e){return function(t,a){return I.a.setToken(a().auth.token),t({type:"DELETE_DRAFT_INVOICE",payload:I.a.requests.post("invoices/".concat(e,"/delete-draft")).then(function(e){return e.success&&t(he()),e})})}}})(Object(fe.a)(function(e){return{root:{width:"100%",marginTop:0*e.spacing.unit,overflowX:"auto",overflowY:"auto",height:"12rem"},header:{position:"sticky",top:0},table:{minWidth:"100%"}}})(we)),Le=a(289),Te=a(273),je=a(201),xe=function(e,t,a){var n=!1;return a.forEach(function(a){JSON.stringify(e[a])!==JSON.stringify(t[a])&&(n=!0)}),n},Se=function(){return r.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 11 13"},r.a.createElement("g",{id:"Create-Estimate",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"Desktop-HD",transform:"translate(-1163.000000, -578.000000)",fill:"#797979",fillRule:"nonzero"},r.a.createElement("g",{id:"room-list-item",transform:"translate(762.000000, 578.000000)"},r.a.createElement("g",{id:"delete-button",transform:"translate(351.000000, 0.000000)"},r.a.createElement("g",{id:"garbage",transform:"translate(50.000000, 0.000000)"},r.a.createElement("path",{d:"M10.7708333,1.3220339 L7.55241667,1.3220339 C7.52720833,1.04661017 7.43897917,0.582135593 7.1369375,0.284016949 C6.9458125,0.0956271186 6.70335417,0 6.4164375,0 L4.125,0 C3.83808333,0 3.595625,0.0956271186 3.4045,0.284016949 C3.10245833,0.582135593 3.01422917,1.04661017 2.98902083,1.3220339 L0.229166667,1.3220339 C0.102666667,1.3220339 0,1.42052542 0,1.54237288 C0,1.66422034 0.102666667,1.76271186 0.229166667,1.76271186 L0.696895833,1.76271186 L1.13575,11.9029322 C1.14422917,12.2823559 1.38989583,13 2.2605,13 L8.7395,13 C9.61010417,13 9.85577083,12.2823559 9.86402083,11.9075593 L10.3031042,1.76271186 L10.7708333,1.76271186 C10.8973333,1.76271186 11,1.66422034 11,1.54237288 C11,1.42052542 10.8973333,1.3220339 10.7708333,1.3220339 Z M3.73358333,0.590728814 C3.83625,0.489813559 3.96435417,0.440677966 4.125,0.440677966 L6.4164375,0.440677966 C6.57708333,0.440677966 6.7051875,0.489813559 6.80785417,0.590728814 C6.99233333,0.772067797 7.06635417,1.09111864 7.09202083,1.3220339 L3.44964583,1.3220339 C3.4753125,1.09111864 3.54933333,0.772067797 3.73358333,0.590728814 Z M9.40591667,11.893678 C9.40454167,11.9617627 9.37291667,12.559322 8.7395,12.559322 L2.2605,12.559322 C1.63395833,12.559322 1.596375,11.960661 1.59385417,11.8890508 L1.15545833,1.76271186 L9.8443125,1.76271186 L9.40591667,11.893678 Z",id:"Shape"})))))))},Fe=a(108),ke=a(556),De=function(e){function t(){var e,a;Object(q.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(H.a)(this,(e=Object(K.a)(t)).call.apply(e,[this].concat(l)))).state={open:!1},a}return Object(W.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.lineItem,n=t.lineItemUUID,o=t.roomUUID,s=this.state.open;return r.a.createElement(l.Fragment,null,r.a.createElement(Ne.a,null,r.a.createElement(ye.a,{align:"right"},r.a.createElement("div",{className:"h-100 items-center flex flex-row pointer dim",onClick:function(){return e.setState(function(e){return{open:!e.open}})}},r.a.createElement("p",{className:"dinTitle f7 mid-gray tc"},"Edit"),r.a.createElement("div",{className:"ArrowIcon rotate-90 mh2"},r.a.createElement($,null)))),r.a.createElement(ye.a,{align:"right"},r.a.createElement("button",{onClick:function(){return e.props.removeLineItem(o,n)},className:"dinTitle f8 mid-gray ba b--red tracked ttu tc pa1 br2 red dim pointer o-70"},"Delete")),r.a.createElement(ye.a,{align:"right"},a.description),r.a.createElement(ye.a,{align:"right"},a.quantity),r.a.createElement(ye.a,{align:"right"},a.uom),r.a.createElement(ye.a,{align:"right"},a.laborCost),r.a.createElement(ye.a,{align:"right"},a.materialCost),r.a.createElement(ye.a,{align:"right"},a.totalMaterial),r.a.createElement(ye.a,{align:"right"},a.totalLabor)),r.a.createElement(Ne.a,{className:"relative",style:{height:"auto"}},r.a.createElement("td",{colSpan:"12"},r.a.createElement(ke.a,{in:s,component:"div",style:{display:"block",width:"100%"}},r.a.createElement("div",{className:"LineItem__container flex flex-column vw-100 w-100-l pv2 ph2"},r.a.createElement("div",{className:"flex flex-column flex-grow-1 mr2"},r.a.createElement("input",{className:"InputField w-100",type:"text",name:"description",placeholder:"Enter the line-item's description",value:a.description,onChange:function(t){return e.props.handleLineItemChange(t,o,n)}}),r.a.createElement("label",{htmlFor:"newLineItemDescription"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"description"))),r.a.createElement("div",{className:"flex flex-row items-center flex-wrap justify-start"},r.a.createElement("div",{className:"w-20 flex flex-column items-start mr2"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"quantity",placeholder:"1",onBlur:function(t){return e.props.handleCostInputBlur(t,o,n)},value:a.quantity,onChange:function(t){return e.props.handleLineItemChange(t,o,n)}}),r.a.createElement("label",{htmlFor:"newLineItemQuantity"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"qty"))),r.a.createElement("div",{className:"w-20 flex flex-column items-start mr2"},r.a.createElement("div",{className:"relative InputField flex flex-row justify-center pointer"},r.a.createElement("p",{className:"dinLabel ttu mid-gray f7 pa0 ma0 self-center mr3"},a.uom||"UOM"),r.a.createElement("div",{className:"ArrowIcon self-center rotate-90"},r.a.createElement($,null)),r.a.createElement("select",{onChange:function(t){return e.props.handleLineItemChange(t,o,n)},name:"uom",className:"absolute z-2 top-0 left-0 w-100 h-100 o-0 pointer ttc"},r.a.createElement("option",{value:"CY"},"cubic yard"),r.a.createElement("option",{value:"DA"},"day"),r.a.createElement("option",{value:"EA"},"each"),r.a.createElement("option",{value:"HR"},"hour"),r.a.createElement("option",{value:"JC"},"job cost"),r.a.createElement("option",{value:"LF"},"linear foot"),r.a.createElement("option",{value:"LS"},"lump sum"),r.a.createElement("option",{value:"MC"},"mininum change"),r.a.createElement("option",{value:"MO"},"month"),r.a.createElement("option",{value:"RM"},"room"),r.a.createElement("option",{value:"SF"},"square foot"),r.a.createElement("option",{value:"SQ"},"square"),r.a.createElement("option",{value:"SY"},"square yard"),r.a.createElement("option",{value:"TN"},"ton"),r.a.createElement("option",{value:"WK"},"week"))),r.a.createElement("label",{htmlFor:"newLineItemUOM"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttu"},"uom"))),r.a.createElement("div",{className:"flex flex-grow-0 flex-column items-start mr2"},r.a.createElement("div",{className:"flex flex-row items-center"},r.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),r.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:function(t){return e.props.handleCostInputBlur(t,o,n)},className:"InputField tc",name:"laborCost",value:a.laborCost,onChange:function(t){return e.props.handleLineItemChange(t,o,n)}})),r.a.createElement("label",{htmlFor:"newLineItemLaborCost"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc pl1"},"labor"))),r.a.createElement("div",{className:"w-20 flex flex-column items-start mr2"},r.a.createElement("div",{className:"flex flex-row items-center"},r.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),r.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:function(t){return e.props.handleCostInputBlur(t,o,n)},className:"InputField tc",name:"materialCost",value:a.materialCost,onChange:function(t){return e.props.handleLineItemChange(t,o,n)}})),r.a.createElement("label",{htmlFor:"newLineItemMaterialCost"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc pl1"},"material")))),r.a.createElement("div",{className:"flex flex-column w-100 mt4"},r.a.createElement("button",{onClick:function(){return e.props.saveCopyOfLineItem(o,n)},className:"dinTitle f7 mid-gray tracked ttu tc bn pa3 bg-black-10 dim"},"save copy of line-item for reuse")))))))}}]),t}(l.Component),Ae=function(e){function t(e){return Object(q.a)(this,t),Object(H.a)(this,Object(K.a)(t).call(this,e))}return Object(W.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){Object.keys(this.props.room).length||this.props.history.goBack()}},{key:"render",value:function(){var e=this,t=this.props.match.params.roomId,a=this.props,n=a.classes,l=a.allSavedLineItems,o=a.setNewLineItemInState,s=a.saveCopyOfLineItem;return r.a.createElement("div",{className:"LineItems fixed top-0 left-0 w-100 z-1 vh-100 bg-black-70"},r.a.createElement("div",{className:"fixed top-0 left-0 vh-75 w-100 bg-white overflow-scroll"},r.a.createElement("div",{className:"measure-70 flex flex-column center ph2 z-3"},r.a.createElement("p",{className:"sticky top-0 dinTitle pa0 ma0 f3 mb3 ttc pt4 bg-white-70 z-4"},"line items",r.a.createElement("span",{className:"mid-gray f5 ttc db pt1"},this.props.room.name)),r.a.createElement("div",{className:"relative h-auto w-100 min-height-vh-75"},r.a.createElement("div",{className:"w-100"},r.a.createElement(Ie.a,{className:n.root},r.a.createElement(Ee.a,{className:n.table},r.a.createElement(Ce.a,null,r.a.createElement(Ne.a,null,r.a.createElement(ye.a,{align:"right"},r.a.createElement("span",{className:"green"},"Edit")),r.a.createElement(ye.a,{align:"right"},r.a.createElement("span",{className:"red"},"Delete")),r.a.createElement(ye.a,{align:"right"},"Description"),r.a.createElement(ye.a,{align:"right"},"Quantity"),r.a.createElement(ye.a,{align:"right"},"UOM"),r.a.createElement(ye.a,{align:"right"},"Labor Cost"),r.a.createElement(ye.a,{align:"right"},"Material Cost"),r.a.createElement(ye.a,{align:"right"},"Total Material"),r.a.createElement(ye.a,{align:"right"},"Total Labor"))),r.a.createElement(ve.a,null,Object.keys(this.props.room).length&&Object.keys(this.props.room.lineItems).map(function(a,n){var l=e.props.room.lineItems[a];if(void 0!==l)return r.a.createElement(De,{lineItem:l,key:n,roomUUID:t,lineItemUUID:a,handleLineItemChange:e.props.handleLineItemChange,handleCostInputBlur:e.props.handleCostInputBlur,removeLineItem:e.props.removeLineItem,saveCopyOfLineItem:s})}))))),r.a.createElement("div",{className:"flex flex-column flex-row-l justify-between pv4"},r.a.createElement("div",{className:"w-100 w-50-l br bw1 b--light-gray pr4"},r.a.createElement("div",{className:"NewLineItem__container ph1 pb2"},this.props.errors.newLineItem&&r.a.createElement("p",{className:"dinLabel red f6 o-70"}," ",this.props.errors.newLineItem," "),r.a.createElement("input",{className:"InputField measure-1 ml3",type:"text",name:"newLineItemDescription",placeholder:"Enter the line-item's description",value:this.props.newLineItemDescription,onChange:this.props.handleChange}),r.a.createElement("label",{htmlFor:"newLineItemDescription"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc tc"},"description")),r.a.createElement("div",{className:"flex flex-row items-center flex-wrap justify-start"},r.a.createElement("div",{className:"w-auto w-20-l flex flex-column items-center mr2 ml3"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"newLineItemQuantity",placeholder:"1",onChange:this.props.handleChange,value:this.props.newLineItemQuantity}),r.a.createElement("label",{htmlFor:"newLineItemQuantity"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"qty"))),r.a.createElement("div",{className:"w-auto w-20-l flex flex-column items-center mr2 ml3"},r.a.createElement("div",{className:"relative InputField flex flex-row justify-center pointer ph3"},r.a.createElement("p",{className:"dinLabel ttu mid-gray f7 pa0 ma0 self-center mr3"},this.props.newLineItemUOM||"UOM"),r.a.createElement("div",{className:"ArrowIcon self-center rotate-90"},r.a.createElement($,null)),r.a.createElement("select",{onChange:this.props.handleChange,name:"newLineItemUOM",className:"absolute z-2 top-0 left-0 w-100 h-100 o-0 pointer ttc"},r.a.createElement("option",{value:"CY"},"cubic yard"),r.a.createElement("option",{value:"DA"},"day"),r.a.createElement("option",{value:"EA"},"each"),r.a.createElement("option",{value:"HR"},"hour"),r.a.createElement("option",{value:"JC"},"job cost"),r.a.createElement("option",{value:"LF"},"linear foot"),r.a.createElement("option",{value:"LS"},"lump sum"),r.a.createElement("option",{value:"MC"},"mininum change"),r.a.createElement("option",{value:"MO"},"month"),r.a.createElement("option",{value:"RM"},"room"),r.a.createElement("option",{value:"SF"},"square foot"),r.a.createElement("option",{value:"SQ"},"square"),r.a.createElement("option",{value:"SY"},"square yard"),r.a.createElement("option",{value:"TN"},"ton"),r.a.createElement("option",{value:"WK"},"week"))),r.a.createElement("label",{htmlFor:"newLineItemUOM"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttu"},"uom"))),r.a.createElement("div",{className:"w-auto w-20-l flex flex-column items-center mr2"},r.a.createElement("div",{className:"flex flex-row items-center"},r.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),r.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:this.props.handleCostInputBlur,className:"InputField tc",name:"newLineItemLaborCost",value:this.props.newLineItemLaborCost,onChange:this.props.handleChange})),r.a.createElement("label",{htmlFor:"newLineItemLaborCost"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"labor"))),r.a.createElement("div",{className:"w-auto w-20-l flex flex-column items-center mr2"},r.a.createElement("div",{className:"flex flex-row items-center"},r.a.createElement("span",{className:"dinLabel f7 mh1"},"$"),r.a.createElement("input",{type:"number",step:"0.01",min:"0.00",onBlur:this.props.handleCostInputBlur,className:"InputField tc",name:"newLineItemMaterialCost",value:this.props.newLineItemMaterialCost,onChange:this.props.handleChange})),r.a.createElement("label",{htmlFor:"newLineItemMaterialCost"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f7 ttc"},"material")))),r.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",onClick:function(){return e.props.addNewLineItem(t)}},"add line item"))),r.a.createElement("div",{className:"w-100 w-50-l bt b--light-gray bw1 pt2 mt2 mt0-l bn-l pt0-l"},r.a.createElement("p",{className:"dinTitle f7 mid-gray tc tr-l pt1"},"Saved Line-Items"),r.a.createElement("div",{className:"pl3-l"},r.a.createElement(Ie.a,{className:n.root},r.a.createElement(Ee.a,{className:n.table},r.a.createElement(Ce.a,null,r.a.createElement(Ne.a,null,r.a.createElement(ye.a,{align:"right"},r.a.createElement("span",{className:"green"},"Re-use")),r.a.createElement(ye.a,{align:"right"},"Description"),r.a.createElement(ye.a,{align:"right"},"Quantity"),r.a.createElement(ye.a,{align:"right"},"UOM"),r.a.createElement(ye.a,{align:"right"},"Labor Cost"),r.a.createElement(ye.a,{align:"right"},"Material Cost"))),r.a.createElement(ve.a,null,l.map(function(e,t){if(void 0!==e)return r.a.createElement(Ne.a,{key:t},r.a.createElement(ye.a,{align:"right"},r.a.createElement("div",{className:"h-100 items-center flex flex-row pointer dim",onClick:function(){o({description:e.description,quantity:e.quantity,UOM:e.uom,laborUnitPrice:e.laborUnitPrice,materialUnitPrice:e.materialUnitPrice})}},r.a.createElement("p",{className:"dinTitle f7 mid-gray tc"},"Re-use"))),r.a.createElement(ye.a,{align:"right"},e.description),r.a.createElement(ye.a,{align:"right"},e.quantity||"n/a"),r.a.createElement(ye.a,{align:"right"},e.uom||"n/a"),r.a.createElement(ye.a,{align:"right"},e.laborUnitPrice||"n/a"),r.a.createElement(ye.a,{align:"right"},e.materialUnitPrice||"n/a"))})))))))),r.a.createElement("div",{className:"sticky bottom-0 dib self-center w-100 bg-white"},r.a.createElement("p",{className:"dinLabel mid-gray f6 ttu pointer tc dim",onClick:function(){return e.props.history.goBack()}},"close")))))}}]),t}(l.Component),_e=function(e){function t(e){var a;return Object(q.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(Y.a)(Object(Y.a)(a))),a.addNewRoom=a.addNewRoom.bind(Object(Y.a)(Object(Y.a)(a))),a.autoSave=a.autoSave.bind(Object(Y.a)(Object(Y.a)(a))),a.addNewLineItem=a.addNewLineItem.bind(Object(Y.a)(Object(Y.a)(a))),a.handleCostInputBlur=a.handleCostInputBlur.bind(Object(Y.a)(Object(Y.a)(a))),a.calculateTotals=a.calculateTotals.bind(Object(Y.a)(Object(Y.a)(a))),a.handleLineItemChange=a.handleLineItemChange.bind(Object(Y.a)(Object(Y.a)(a))),a.handleImageChange=a.handleImageChange.bind(Object(Y.a)(Object(Y.a)(a))),a.removeRoom=a.removeRoom.bind(Object(Y.a)(Object(Y.a)(a))),a.removeLineItem=a.removeLineItem.bind(Object(Y.a)(Object(Y.a)(a))),a.sumTotals=a.sumTotals.bind(Object(Y.a)(Object(Y.a)(a))),a.removeUploadedImage=a.removeUploadedImage.bind(Object(Y.a)(Object(Y.a)(a))),a.sumRoomTotals=a.sumRoomTotals.bind(Object(Y.a)(Object(Y.a)(a))),a.uploadImage=a.uploadImage.bind(Object(Y.a)(Object(Y.a)(a))),a.generateInvoice=a.generateInvoice.bind(Object(Y.a)(Object(Y.a)(a))),a.setNewLineItemInState=a.setNewLineItemInState.bind(Object(Y.a)(Object(Y.a)(a))),a.saveCopyOfLineItem=a.saveCopyOfLineItem.bind(Object(Y.a)(Object(Y.a)(a))),a.addCreditToRunningTotals=a.addCreditToRunningTotals.bind(Object(Y.a)(Object(Y.a)(a))),a.invoiceContainerRef=Object(l.createRef)(),a.draftTimeoutId=null,a.customerKnackId="",a.whitelistedKeys=["invoiceName","customersFullName","customersAddress","customersCityState","customersZipCode","insuranceCarrier","policyNumber","claimNumber","dateOfLoss","rooms","totalLaborCost","totalMaterialCost","totalCost","creditToApply"],a.state={invoiceName:"",insuranceCarrier:"",policyNumber:"",claimNumber:"",dateOfLoss:"2019-01-01",customersFullName:"",customersAddress:"",customersCityState:"",customersZipCode:"",newRoomName:"",newRoomLength:"",newRoomWidth:"",newRoomHeight:"8",newRoomLineItems:"",newLineItemDescription:"",newLineItemQuantity:"1",newLineItemUOM:"",newLineItemLaborCost:"0.00",newLineItemMaterialCost:"0.00",allSavedLineItems:[],rooms:{},totalLaborCost:"0",totalMaterialCost:"0",totalCost:"0",creditToApply:"0",errors:{newRoom:"",newLineItem:"",roomImages:"",allSavedLineItems:""},uploadedImages:{},beginAutoSave:!1,autoSaving:!1,generatingInvoice:!1,applyCredit:!1,uploadingImage:!1},a}return Object(W.a)(t,e),Object(G.a)(t,[{key:"sumTotals",value:function(e,t){if(void 0!==this.state.rooms[e])return Object.keys(t).reduce(function(e,a){var n=t[a];return void 0===n||"undefined"===typeof n?e:(e.totalLabor=(parseFloat(e.totalLabor)+parseFloat(n.totalLabor)).toFixed(2),e.totalMaterial=(parseFloat(e.totalMaterial)+parseFloat(n.totalMaterial)).toFixed(2),e.totalCost=(parseFloat(e.totalCost)+parseFloat(n.total)).toFixed(2),e)},{totalLabor:"0",totalMaterial:"0",totalCost:"0"})}},{key:"sumRoomTotals",value:function(){var e=this;return Object.keys(this.state.rooms).reduce(function(t,a){var n=e.state.rooms[a];if(void 0===n)return t;var l=n.roomTotals,r=l.totalLabor,o=l.totalMaterial,s=l.totalCost;return t.totalLaborCost=(parseFloat(t.totalLaborCost)+parseFloat(r)).toFixed(2),t.totalMaterialCost=(parseFloat(t.totalMaterialCost)+parseFloat(o)).toFixed(2),t.totalCost=(parseFloat(t.totalCost)+parseFloat(s)).toFixed(2),t},{totalLaborCost:"0",totalMaterialCost:"0",totalCost:"0"})}},{key:"addCreditToRunningTotals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",a=(parseFloat(e.totalCost)-parseFloat(t)).toFixed(2);return Object(p.a)({},e,{totalCost:isNaN(a)?e.totalCost:a<0?"0.00":a})}},{key:"componentDidUpdate",value:function(e,t){t.rooms===this.state.rooms&&t.creditToApply===this.state.creditToApply||this.setState(Object(p.a)({},this.addCreditToRunningTotals(this.sumRoomTotals(),this.state.creditToApply))),this.state.beginAutoSave&&xe(t,this.state,this.whitelistedKeys)&&(this.draftTimeoutId&&clearTimeout(this.draftTimeoutId),this.draftTimeoutId=setTimeout(this.autoSave,1250))}},{key:"componentDidMount",value:function(){var e=this,t=this.props.token;if(I.a.setToken(t),I.a.requests.get("line-items").then(function(t){var a=t.success,n=t.allSavedLineItems;a&&e.setState({allSavedLineItems:n})}).catch(function(t){console.log("Error while fetching all saved line-items",t),e.setState({errors:Object(p.a)({},e.state.errors,{allSavedLineItems:"Sorry, we could not load the saved line-items right now. Please refresh the page and try again."})})}),this.props.location.search){var a=this.props.location.search.replace(/(^\?)/,"").split("&").reduce(function(e,t){var a=t.split("="),n=Object(Le.a)(a,2),l=n[0],r=n[1];return e[l]=r,e},{});a.customer_id&&(this.customerKnackId=a.customer_id,I.a.requests.get("knack/search-customers/".concat(a.customer_id)).then(function(t){return 401===t.response.statusCode&&e.props.dispatch({type:"LOGOUT"}),t}).then(function(a){var n=a.response,l=n.body["".concat("field_15","_raw")],r=n.body["".concat("field_59","_raw")],o=r.city,s=r.state,i=r.zip,c=r.street,m=r.street2,u=n.body["".concat("field_299","_raw")];return I.a.setToken(t),I.a.requests.post("invoices/".concat(e.props.match.params.draftId)).then(function(t){e.setState(Object(p.a)({},e.state,{invoiceName:t.invoiceName,customersFullName:l||"",customersAddress:"".concat(c||""," ").concat(m||""),customersCityState:o&&s?"".concat(o," , ").concat(s):"",customersZipCode:i||"",insuranceCarrier:t.claim.insuranceCarrier,policyNumber:t.claim.policyNumber,claimNumber:u&&u.trim()||t.claim.claimNumber,dateOfLoss:t.claim.dateOfLoss,rooms:t.rooms||{},totalLaborCost:t.totalLaborCost,totalMaterialCost:t.totalMaterialCost,totalCost:t.totalCost,uploadedImages:t.images?t.images:{},customerKnackId:e.customerKnackId,beginAutoSave:!0}))})}).catch(function(e){console.log("error fetching customer in CreateInvoice",e)}))}else I.a.requests.post("invoices/".concat(this.props.match.params.draftId)).then(function(t){e.setState(Object(p.a)({},e.state,{invoiceName:t.invoiceName,customersFullName:t.customer.fullName,customersAddress:t.customer.address,customersCityState:t.customer.cityState,customersZipCode:t.customer.zipCode,insuranceCarrier:t.claim.insuranceCarrier,policyNumber:t.claim.policyNumber,claimNumber:t.claim.claimNumber,dateOfLoss:t.claim.dateOfLoss,rooms:t.rooms||{},totalLaborCost:t.totalLaborCost,totalMaterialCost:t.totalMaterialCost,totalCost:t.totalCost,uploadedImages:t.images?t.images:{},customerKnackId:t.customer.customerKnackId,beginAutoSave:!0}))}).catch(function(t){422===t.status&&t.response&&"NOT_DRAFT"===t.response.body.error&&e.props.history.push("/invoices/pdf/".concat(e.props.match.params.draftId)),console.log("There was an error when attempting find or create a draft invoice on CreateInvoice componentDidMount",Object(p.a)({},t))})}},{key:"componentWillUnmount",value:function(){this.draftTimeoutId&&clearTimeout(this.draftTimeoutId)}},{key:"uploadImage",value:function(e){var t=this;Object.keys(e).forEach(function(a){t.setState({uploadingImage:!0});var n=e[a].file;delete Object(p.a)({},e)[a],I.a.requests.postImage("invoices/".concat(t.props.match.params.draftId),n).then(function(e){t.setState(Object(p.a)({},t.state,{uploadedImages:e.images}))}).catch(function(e){422===e.status&&e.response&&"NOT_DRAFT"===e.response.body.error&&alert("This invoice is no longer a draft please therefore it can no longer be modified. Either create a new invoice or refresh the page to view the generated PDF."),console.log("There was an error when attempting find or create a draft invoice on CreateInvoice uploadImage",Object(p.a)({},e))}).finally(function(){t.setState({uploadingImage:!1})})})}},{key:"saveCopyOfLineItem",value:function(e,t){var a=this,n=this.props.token,l=this.state.rooms[e].lineItems[t],r=l.description,o=l.laborCost,s=l.materialCost,i=l.quantity,c=l.uom;I.a.setToken(n),I.a.requests.post("line-items/save",{lineItemDescription:r,lineItemMaterialUnitPrice:s,lineItemLaborUnitPrice:o,lineItemQuantity:i,lineItemUnitOM:c}).then(function(e){console.log("response is",e);var t=e.success,n=e.allSavedLineItems;t&&a.setState({allSavedLineItems:n})}).catch(function(e){console.log("Error while saving line-item",e)})}},{key:"autoSave",value:function(){var e=this,t=Object(p.a)({},this.state);this.setState({autoSaving:!0});var a=this.whitelistedKeys.reduce(function(e,a){return e[a]=t[a],e},{}),n=this.props.token;I.a.setToken(n),I.a.requests.post("invoices/".concat(this.props.match.params.draftId),Object(p.a)({customerKnackId:this.state.customerKnackId},a)).then(function(t){e.setState({autoSaving:!1})}).catch(function(t){422===t.status&&t.response&&"NOT_DRAFT"===t.response.body.error&&(alert("NOT A DRAFT"),e.setState({autoSaving:!1})),console.log("There was an error when attempting find or create a draft invoice on CreateInvoice autoSave",Object(p.a)({},t))})}},{key:"handleLineItemChange",value:function(e,t,a){var n=this,l=e.target.name,r=e.target.value,o=function(e){var o,s=n.calculateTotals("quantity"===l?r.trim()||"0":e.rooms[t].lineItems[a].quantity.trim()||"0",e.rooms[t].lineItems[a].uom,"laborCost"===l?r.trim()||"0":e.rooms[t].lineItems[a].laborCost.trim()||"0","materialCost"===l?r.trim()||"0":e.rooms[t].lineItems[a].materialCost.trim()||"0"),i=s.laborTotal,c=s.materialTotal,m=s.combinedTotal;return Object(p.a)({},e.rooms[t].lineItems[a],(o={},Object(ne.a)(o,l,r),Object(ne.a)(o,"totalLabor",i),Object(ne.a)(o,"totalMaterial",c),Object(ne.a)(o,"total",m),o))}(this.state);return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},t,Object(p.a)({},this.state.rooms[t],{lineItems:Object(p.a)({},this.state.rooms[t].lineItems,Object(ne.a)({},a,o)),roomTotals:Object(p.a)({},this.state.rooms[t].roomTotals,this.sumTotals(t,Object(p.a)({},this.state.rooms[t].lineItems,Object(ne.a)({},a,o))))})))}))}},{key:"handleChange",value:function(e,t){var a=t;if(!a)return this.setState(Object(p.a)({},this.state,Object(ne.a)({},e.target.name,e.target.value)));var n=e.target.name,l=e.target.value;this.setState(function(e){return Object(p.a)({},e,{rooms:Object(p.a)({},e.rooms,Object(ne.a)({},a,Object(p.a)({},e.rooms[a],Object(ne.a)({},n,l))))})})}},{key:"handleCostInputBlur",value:function(e,t,a){var n=this;if(a&&t&&("laborCost"===e.target.name||"materialCost"===e.target.name||"quantity"===e.target.name)){return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},t,Object(p.a)({},this.state.rooms[t],{lineItems:Object(p.a)({},this.state.rooms[t].lineItems,Object(ne.a)({},a,function(l){var r,o;return n.state.rooms[t].lineItems[a][e.target.name].trim()?(o=n.calculateTotals(l.rooms[t].lineItems[a].quantity,l.rooms[t].lineItems[a].uom,l.rooms[t].lineItems[a].laborCost,l.rooms[t].lineItems[a].materialCost),Object(p.a)({},l.rooms[t].lineItems[a],{totalLabor:o.laborTotal,totalMaterial:o.materialTotal,total:o.combinedTotal})):("laborCost"===e.target.name?o=n.calculateTotals(l.rooms[t].lineItems[a].quantity,l.rooms[t].lineItems[a].uom,"0.00",l.rooms[t].lineItems[a].materialCost):"materialCost"===e.target.name?o=n.calculateTotals(l.rooms[t].lineItems[a].quantity,l.rooms[t].lineItems[a].uom,l.rooms[t].lineItems[a].laborCost,"0.00"):"quantity"===e.target.name&&(o=n.calculateTotals("0",l.rooms[t].lineItems[a].uom,l.rooms[t].lineItems[a].laborCost,l.rooms[t].lineItems[a].materialCost)),Object(p.a)({},l.rooms[t].lineItems[a],(r={},Object(ne.a)(r,e.target.name,"quantity"===e.target.name?"0":"0.00"),Object(ne.a)(r,"totalLabor",o.laborTotal),Object(ne.a)(r,"totalMaterial",o.materialTotal),Object(ne.a)(r,"total",o.combinedTotal),r)))}(this.state)))})))}))}if(("newLineItemLaborCost"===e.target.name||"newLineItemMaterialCost"===e.target.name)&&!this.state[e.target.name].trim())return this.setState(Object(ne.a)({},e.target.name,"0.00"))}},{key:"calculateTotals",value:function(e,t,a,n){var l=(parseFloat(e)*parseFloat(a)).toFixed(2),r=(parseFloat(e)*parseFloat(n)).toFixed(2);return{laborTotal:l,materialTotal:r,combinedTotal:(parseFloat(l)+parseFloat(r)).toFixed(2)}}},{key:"setNewLineItemInState",value:function(e){this.setState({newLineItemDescription:e.description||"",newLineItemQuantity:"".concat(e.quantity)||"1",newLineItemUOM:e.UOM||"",newLineItemLaborCost:e.laborUnitPrice||"0.00",newLineItemMaterialCost:e.materialUnitPrice||"0.00"})}},{key:"addNewLineItem",value:function(e){var t=this,a=this.state,n=a.newLineItemDescription,l=a.newLineItemQuantity,r=a.newLineItemUOM,o=a.newLineItemLaborCost,s=a.newLineItemMaterialCost,i=/^-?\d*(\.\d+)?$/;if(!i.test(o)||!i.test(s)||!i.test(l))return this.setState(function(e){return Object(p.a)({},e,{errors:Object(p.a)({},e.errors,{newLineItem:"Labor cost, material cost, and quantity must be a number"})})});if(!n.trim()||!(l>0)||!r.trim())return this.setState(function(e){return Object(p.a)({},e,{errors:Object(p.a)({},e.errors,{newLineItem:"You must provide a quantity greater than 0, a UOM, and a description"})})});var c=this.calculateTotals(l,r,o,s),m=c.laborTotal,u=c.materialTotal,d=c.combinedTotal,h=X(),b={description:n,uom:r,materialCost:s,laborCost:o,totalMaterial:u,totalLabor:m,quantity:l,total:d};return this.setState(function(a){return{errors:Object(p.a)({},a.errors,{newLineItem:""}),newLineItemDescription:"",newLineItemQuantity:"1",newLineItemUOM:"",newLineItemLaborCost:"0.00",newLineItemMaterialCost:"0.00",rooms:Object(p.a)({},a.rooms,Object(ne.a)({},e,Object(p.a)({},a.rooms[e],{lineItems:Object(p.a)({},a.rooms[e].lineItems,Object(ne.a)({},h,b)),roomTotals:Object(p.a)({},t.state.rooms[e].roomTotals,t.sumTotals(e,Object(p.a)({},t.state.rooms[e].lineItems,Object(ne.a)({},h,b))))})))}})}},{key:"addNewRoom",value:function(){var e=this.state,t=e.newRoomName,a=e.newRoomLength,n=e.newRoomWidth,l=e.newRoomHeight;if(!t.trim().length||!a.trim().length||!n.trim().length||!l.trim().length)return this.setState(function(e){return Object(p.a)({},e,{errors:Object(p.a)({},e.errors,{newRoom:"You must provide all fields for the new room"})})});var r=X();this.setState(function(e){return{errors:Object(p.a)({},e.errors,{newRoom:""}),newRoomName:"",newRoomLength:"",newRoomWidth:"",newRoomHeight:"8",rooms:Object(p.a)({},e.rooms,Object(ne.a)({},r,{name:t,length:a,width:n,height:l,lineItems:[],roomTotals:{totalLabor:"0",totalMaterial:"0",totalCost:"0"}}))}})}},{key:"removeRoom",value:function(e){return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},e,void 0))}))}},{key:"removeLineItem",value:function(e,t){return this.setState(Object(p.a)({},this.state,{rooms:Object(p.a)({},this.state.rooms,Object(ne.a)({},e,Object(p.a)({},this.state.rooms[e],{lineItems:Object(p.a)({},this.state.rooms[e].lineItems,Object(ne.a)({},t,void 0)),roomTotals:Object(p.a)({},this.state.rooms[e].roomTotals,this.sumTotals(e,Object(p.a)({},this.state.rooms[e].lineItems,Object(ne.a)({},t,void 0))))})))}))}},{key:"removeUploadedImage",value:function(e){var t=this,a=this.props.token,n=this.props.match.params.draftId;I.a.setToken(a),I.a.requests.post("invoices/".concat(n,"/remove-image/").concat(encodeURIComponent(e))).then(function(a){a.id===n&&t.setState(Object(p.a)({},t.state,{uploadedImages:Object(p.a)({},t.state.uploadedImages,Object(ne.a)({},e,void 0))}))})}},{key:"handleImageChange",value:function(e){var t=Array.from(e.target.files).reduce(function(e,t){if(!t)return e;var a=X(),n=URL.createObjectURL(t);return e[a]={file:t,previewUrl:n},e},{});this.uploadImage(t)}},{key:"generateInvoice",value:function(){var e=this,t=this.props,a=t.token,n=t.history;return I.a.setToken(a),I.a.requests.post("invoices/".concat(this.props.match.params.draftId,"/generate-invoice")).then(function(t){n.push("/invoices/pdf/".concat(e.props.match.params.draftId))}).catch(function(e){console.log("There is an error in CreateInvoice in generateInvoice",e)})}},{key:"render",value:function(){var e=this;return r.a.createElement(l.Fragment,null,this.state.generatingInvoice?r.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3"},"Generating Invoice ..."):r.a.createElement("div",{ref:this.invoiceContainerRef},r.a.createElement(Te.a,{path:"".concat(this.props.match.path,"/line-items/:roomId"),render:function(t){return r.a.createElement(Ae,Object.assign({handleCostInputBlur:e.handleCostInputBlur,addNewLineItem:e.addNewLineItem,newLineItemLaborCost:e.state.newLineItemLaborCost,newLineItemMaterialCost:e.state.newLineItemMaterialCost,newLineItemUOM:e.state.newLineItemUOM,newLineItemDescription:e.state.newLineItemDescription,newLineItemQuantity:e.state.newLineItemQuantity,handleLineItemChange:e.handleLineItemChange,errors:e.state.errors,handleChange:e.handleChange,removeLineItem:e.removeLineItem,room:e.state.rooms[t.match.params.roomId]||{},allSavedLineItems:e.state.allSavedLineItems,setNewLineItemInState:e.setNewLineItemInState,saveCopyOfLineItem:e.saveCopyOfLineItem},e.props,t))}}),r.a.createElement("div",{className:"flex flex-column measure-70 center ph4 pt5 mb5"},r.a.createElement("div",{className:"flex flex-column flex-row-l w100"},r.a.createElement("div",{className:"flex flex-column w-100 w-50-l pr5-l"},r.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3"},"Invoice Details"),r.a.createElement("input",{className:"InputField",type:"text",name:"invoiceName",placeholder:"Enter the invoice name here",value:this.state.invoiceName,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"invoiceName"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Invoice Name")),r.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3 mt4"},"Customer Details"),r.a.createElement("input",{className:"InputField",type:"text",name:"customersFullName",placeholder:"Enter the customer's full here",value:this.state.customersFullName,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"customersFullName"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Customers Full Name")),r.a.createElement("input",{className:"InputField",type:"text",name:"customersAddress",placeholder:"Enter the customer's address here",value:this.state.customersAddress,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"customersAddress"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Customer's Address")),r.a.createElement("input",{className:"InputField",type:"text",name:"customersCityState",placeholder:"City, State",value:this.state.customersCityState,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"customersCityState"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"City, State")),r.a.createElement("input",{className:"InputField",type:"text",name:"customersZipCode",placeholder:"Zipcode",value:this.state.customersZipCode,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"customersZipcode"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Zip Code")),r.a.createElement("p",{className:"dinTitle pa0 ma0 f4 mid-gray mb3 mt4 ttu"},"claim details"),r.a.createElement("input",{className:"InputField",type:"text",name:"insuranceCarrier",placeholder:"Enter the name of the insurance carrier",value:this.state.insuranceCarrier,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"insuranceCarrier"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Insurance Carrier")),r.a.createElement("input",{className:"InputField",type:"text",name:"policyNumber",placeholder:"Policy Number",value:this.state.policyNumber,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"policyNumber"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Policy Number")),r.a.createElement("input",{className:"InputField",type:"text",name:"claimNumber",placeholder:"Claim Number",value:this.state.claimNumber,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"claimNumber"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Claim Number")),r.a.createElement("input",{className:"InputField measure-1",type:"date",name:"dateOfLoss",value:this.state.dateOfLoss,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"dateOfLoss"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Date of Loss"))),r.a.createElement("div",{className:"flex flex-column w-100 w-50-l pl5-l"},r.a.createElement("p",{className:"dinTitle pa0 ma0 f3 mb3"},"Rooms"),r.a.createElement("div",{className:"NewRoom__container"},this.state.errors.newRoom&&r.a.createElement("p",{className:"dinLabel red f6 o-70"}," ",this.state.errors.newRoom," "),r.a.createElement("input",{className:"InputField measure-1",type:"text",name:"newRoomName",placeholder:"Enter the room name",value:this.state.newRoomName,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"newRoomName"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Room Name")),r.a.createElement("div",{className:"flex flex-row items-center justify-between"},r.a.createElement("div",{className:"flex flex-row items-center justify-between w-50 flex-grow-1"},r.a.createElement("div",{className:"w-30 flex flex-column items-center"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"newRoomLength",placeholder:"0",onChange:this.handleChange,value:this.state.newRoomLength}),r.a.createElement("label",{htmlFor:"newRoomLength"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Length"))),r.a.createElement("div",{className:"w-30 flex flex-column items-center"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"newRoomWidth",placeholder:"0",onChange:this.handleChange,value:this.state.newRoomWidth}),r.a.createElement("label",{htmlFor:"newRoomWidth"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Width"))),r.a.createElement("div",{className:"w-30 flex flex-column items-center"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"newRoomHeight",placeholder:"0",value:this.state.newRoomHeight,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"newRoomHeight"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Height"))))),r.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",onClick:this.addNewRoom},"add room")),r.a.createElement("div",{className:"RoomsAccordion__container mt5"},r.a.createElement(Fe.Accordion,null,Object.keys(this.state.rooms).map(function(t,a){var n=e.state.rooms[t];if(void 0!==n)return r.a.createElement(Fe.AccordionItem,{key:a},r.a.createElement(Fe.AccordionItemHeading,{className:"w-100"},r.a.createElement(Fe.AccordionItemButton,{className:"accordion__button flex flex-row items-center justify-between"},r.a.createElement("p",{className:"tc dinLabel f7 ttu"}," ",n.name||t," "),r.a.createElement("div",{className:"flex flex-row items-center justify-between"},r.a.createElement("button",{onClick:function(){return e.removeRoom(t)},className:"flex flex-row items-center self-center dinLabel f7 mid-gray pointer bn bg-transparent dim ttu"},"delete",r.a.createElement("div",{className:"ArrowIcon mh2"},r.a.createElement(Se,null))),r.a.createElement("div",{className:"ArrowIcon mh2"},r.a.createElement($,null))))),r.a.createElement(Fe.AccordionItemPanel,null,r.a.createElement("div",{className:"EditRoom__container pv4"},r.a.createElement("input",{className:"InputField measure-1",type:"text",name:"name",onChange:function(a){return e.handleChange(a,t)},placeholder:"Enter the room name",value:n.name}),r.a.createElement("label",{htmlFor:"newRoomName"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Room Name")),r.a.createElement("div",{className:"flex flex-row items-center justify-between"},r.a.createElement("div",{className:"flex flex-row items-center justify-between w-50 flex-grow-1"},r.a.createElement("div",{className:"w-30 flex flex-column items-center"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"length",placeholder:"0",onChange:function(a){return e.handleChange(a,t)},value:n.length}),r.a.createElement("label",{htmlFor:"newRoomLength"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Length"))),r.a.createElement("div",{className:"w-30 flex flex-column items-center"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"width",placeholder:"0",onChange:function(a){return e.handleChange(a,t)},value:n.width}),r.a.createElement("label",{htmlFor:"newRoomWidth"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Width"))),r.a.createElement("div",{className:"w-30 flex flex-column items-center"},r.a.createElement("input",{className:"InputField tc",type:"number",name:"height",placeholder:"8",onChange:function(a){return e.handleChange(a,t)},value:n.height}),r.a.createElement("label",{htmlFor:"newRoomHeight"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Height"))))),r.a.createElement(je.a,{to:"".concat(e.props.match.path.replace(":draftId",e.props.match.params.draftId),"/line-items/").concat(t)},r.a.createElement("div",{className:"flex flex-row items-center dinLabel f7 mid-gray self-start pointer bt-0 bl-0 br-0 bg-transparent mt2"},"ADD/EDIT LINE ITEMS")))))}))),r.a.createElement("div",{className:"mt4"},this.state.errors.roomImages&&r.a.createElement("p",{className:"dinLabel red f6 o-70"}," ",this.state.errors.roomImages," "),r.a.createElement("div",{className:"ImageUploads__container relative w-40 ba bw1 flex items-center justify-center pv2 b--light-gray br2 flex-row"},r.a.createElement("input",{type:"file",name:"roomImages",className:"absolute w-100 h-100 o-0 pointer",onChange:this.handleImageChange,accept:"image/*",disabled:this.state.uploadingImage,multiple:!0}),r.a.createElement("p",{className:"dinLabel pa0 ma0 f7 gray ttu dib pointer tc ".concat(this.state.uploadingImage?"o-20":"")},this.state.uploadingImage?"Uploading Image ...":"Upload images")),r.a.createElement("div",{className:"w-100 mt3"},r.a.createElement("ul",{className:"list pa0 ma0 flex flex-row overflow-x-scroll overflow-y-hidden h100 pb2"},Object.keys(this.state.uploadedImages).map(function(t,a){var n=e.state.uploadedImages[t];if(void 0!==n&&"undefined"!==typeof n)return r.a.createElement("li",{key:a},r.a.createElement("div",{className:"RoomImagesContainer mr2 flex flex-column pb4"},r.a.createElement("img",{src:n.url,width:"auto",height:"270"}),r.a.createElement("button",{onClick:function(){return e.removeUploadedImage(t)},className:"flex flex-row items-center self-center dinLabel f7 mid-gray pointer bn bg-transparent dim ttu"},"delete",r.a.createElement("div",{className:"ArrowIcon mh2"},r.a.createElement(Se,null)))))})))))),r.a.createElement("div",{className:"flex flex-column w-100 mt4"},r.a.createElement("ul",{className:"list bb b-w1 b--light-gray pa0"},Object.keys(this.state.rooms).map(function(t,a){var n=e.state.rooms[t];if(void 0!==n)return r.a.createElement("li",{className:"flex flex-column flex-row-l items-center justify-between",key:a},r.a.createElement("p",{className:"dinLabel f6 ttu"},n.name||t),r.a.createElement("div",{className:"flex flex-column flex-column-reverse flex-row-l flex-row-reverse-l"},r.a.createElement("p",{className:"dinLabel f7 pa0 mh1"},r.a.createElement("span",{className:"ttu black-60"},"total: "),"$",n.roomTotals.totalCost),r.a.createElement("p",{className:"dinLabel f7 pa0 mh1"},r.a.createElement("span",{className:"ttu black-60"},"total material: "),"$",n.roomTotals.totalMaterial),r.a.createElement("p",{className:"dinLabel f7 pa0 mh1"},r.a.createElement("span",{className:"ttu black-60"},"total labor: "),"$",n.roomTotals.totalLabor)))})),r.a.createElement("div",{className:"flex flex-column flex-row-l items-center justify-between"},r.a.createElement("ul",{className:"list pa0 tl"},r.a.createElement("li",null,r.a.createElement("p",{className:"dinLabel f6"},r.a.createElement("span",{className:"ttu black-70"},"total labor: "),"$",this.state.totalLaborCost)),r.a.createElement("li",null,r.a.createElement("p",{className:"dinLabel f6"},r.a.createElement("span",{className:"ttu black-70"},"total material: "),"$",this.state.totalMaterialCost)),r.a.createElement("li",null,r.a.createElement("div",{className:"dinLabel f6"},r.a.createElement("span",{className:"ttu black-70"},"total cost: "),"$",this.state.totalCost,!this.state.applyCredit&&this.state.creditToApply>0?r.a.createElement(l.Fragment,null,r.a.createElement("span",{className:"db tl ttu f8 green o-2"},"(credit applied $",parseFloat(this.state.creditToApply).toFixed(2),")"),r.a.createElement("button",{onClick:function(){return e.setState({applyCredit:!e.state.applyCredit})},className:"db mt1 dinTitle f8 mid-gray ba b--green tracked ttu tc pa2 br2 green 0-2 dim"},"apply credit")):this.state.applyCredit?r.a.createElement("div",{className:"flex flex-column"},r.a.createElement("input",{className:"InputField tc pa0 green",type:"number",name:"creditToApply",onChange:this.handleChange,placeholder:"0.00",value:this.state.creditToApply}),r.a.createElement("label",{htmlFor:"creditToApply"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb2 f8 green tl ttc"},"credit to apply")),r.a.createElement("button",{onClick:function(){return e.setState({applyCredit:!e.state.applyCredit})},className:"db dinTitle f8 mid-gray ba b--green tracked ttu tc pa2 br2 green 0-2 dim"},"done")):r.a.createElement("button",{onClick:function(){return e.setState({applyCredit:!e.state.applyCredit})},className:"db mt1 dinTitle f8 mid-gray ba b--green tracked ttu tc pa2 br2 green 0-2 dim"},"apply credit")))),r.a.createElement("div",{className:"w-40"},r.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",disabled:this.state.autoSaving,onClick:this.generateInvoice},"generate invoice")))))))}}]),t}(l.Component),Re=Object(i.c)(function(e){return{token:e.auth.token}})(Object(fe.a)(function(e){return{root:{width:"100%",marginTop:1*e.spacing.unit,overflowX:"auto",paddingBottom:2*e.spacing.unit},header:{position:"sticky",top:0},table:{minWidth:"100%"}}})(_e)),Ue=Object(le.a)(function(e){return e.globals.settings},function(e){return{companyName:e.companyName,companyPhoneNumber:e.companyPhoneNumber,companyEmail:e.companyEmail,companyAddress:e.companyAddress,companyCityState:e.companyCityState,companyZip:e.companyZip,companyOpeningStatement:e.companyOpeningStatement}});function Me(){return function(e){return e({type:"FETCH_SETTINGS",payload:I.a.requests.get("settings").then(function(t){return 401===t.status?(e({type:"LOGOUT"}),Promise.reject()):t}).catch(function(t){return 401===t.status&&e({type:"LOGOUT"}),Promise.reject(t)})})}}var Pe=function(e){function t(e){var a;return Object(q.a)(this,t),a=Object(H.a)(this,Object(K.a)(t).call(this,e)),console.log("settings is",a.props.globals),a.handleChange=a.handleChange.bind(Object(Y.a)(Object(Y.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(Y.a)(Object(Y.a)(a))),a.state={companyName:"",companyPhoneNumber:"",companyEmail:"",companyAddress:"",companyCityState:"",companyZip:"",companyOpeningStatement:"",requestPending:!1},a}return Object(W.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.globals.settings,t=e.companyName,a=e.companyPhoneNumber,n=e.companyEmail,l=e.companyAddress,r=e.companyCityState,o=e.companyZip,s=e.companyOpeningStatement;this.setState(Object(p.a)({},this.state,{companyName:t,companyPhoneNumber:a,companyEmail:n,companyAddress:l,companyCityState:r,companyZip:o,companyOpeningStatement:s}))}},{key:"componentDidUpdate",value:function(e,t){if(xe(e.globals.settings,this.props.globals.settings,Object.keys(this.state))){var a=this.props.globals.settings,n=a.companyName,l=a.companyPhoneNumber,r=a.companyEmail,o=a.companyAddress,s=a.companyCityState,i=a.companyZip,c=a.companyOpeningStatement;this.setState(Object(p.a)({},this.state,{companyName:n,companyPhoneNumber:l,companyEmail:r,companyAddress:o,companyCityState:s,companyZip:i,companyOpeningStatement:c}))}}},{key:"handleChange",value:function(e){this.setState(Object(p.a)({},this.state,Object(ne.a)({},e.target.name,e.target.value)))}},{key:"handleSubmit",value:function(){var e=this;this.setState(Object(p.a)({},this.state,{requestPending:!0}));var t=this.state,a=t.companyName,n=t.companyPhoneNumber,l=t.companyEmail,r=t.companyAddress,o=t.companyCityState,s=t.companyZip,i=t.companyOpeningStatement;I.a.setToken(this.props.token),I.a.requests.post("settings/update",{companyName:a,companyPhoneNumber:n,companyEmail:l,companyAddress:r,companyCityState:o,companyZip:s,companyOpeningStatement:i}).then(function(){return e.setState(Object(p.a)({},e.state,{requestPending:!1})),e.props.fetchSettings()}).catch(function(t){e.setState(Object(p.a)({},e.state,{requestPending:!1})),console.log("There was an error caught in handleSubmit of Settings",Object(p.a)({},t))})}},{key:"render",value:function(){return r.a.createElement("div",{className:"flex flex-column measure-70 center pt5 mb5"},r.a.createElement("div",{className:"flex flex-row w100"},r.a.createElement("div",{className:"flex flex-column w-100 ph4 w-60-l pr5"},r.a.createElement("p",{className:"dinTitle pa0 ma0 f2 mb1"},"Settings"),r.a.createElement("p",{className:"dinLabel pa0 ma0 f5 mb3 mid-gray"},"The settings below will configure the company header rendered on the ",r.a.createElement("span",{className:"ttu"},"pdf"),"s"),r.a.createElement("input",{className:"InputField",type:"text",name:"companyName",placeholder:"Enter the company name here",value:this.state.companyName,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"companyName"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Name")),r.a.createElement("input",{className:"InputField",type:"text",name:"companyPhoneNumber",placeholder:"Enter the company's phone number",value:this.state.companyPhoneNumber,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"companyPhoneNumber"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Phone Number")),r.a.createElement("input",{className:"InputField",type:"text",name:"companyEmail",placeholder:"Enter the company's email",value:this.state.companyEmail,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"companyEmail"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Email")),r.a.createElement("input",{className:"InputField",type:"text",name:"companyAddress",placeholder:"Enter the company address",value:this.state.companyAddress,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"companyAddress"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Company Address")),r.a.createElement("input",{className:"InputField",type:"text",name:"companyCityState",placeholder:"City, State",value:this.state.companyCityState,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"companyCityState"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"City, State")),r.a.createElement("input",{className:"InputField",type:"text",name:"companyZip",placeholder:"Zip Code",value:this.state.companyZip,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"companyZip"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Zip Code")),r.a.createElement("textarea",{className:"InputField ph4 pt2",type:"text",name:"companyOpeningStatement",placeholder:"Enter the opening statement",onChange:this.handleChange,defaultValue:"Enter the opening statement",value:this.state.companyOpeningStatement}),r.a.createElement("label",{htmlFor:"companyOpeningStatement"},r.a.createElement("p",{className:"dinLabel pa0 ma0 mb3 f6"},"Opening Statement")),r.a.createElement("div",{className:"w-40"},r.a.createElement("button",{className:"GenericButton tc dinLabel pv3 f7 mt3 ttu",disabled:this.props.isLoading.globals.settings||this.props.isError.globals.settings||this.state.requestPending,onClick:this.handleSubmit},"save settings")))))}}]),t}(l.Component),Be=Object(i.c)(function(e){var t=e.status,a=e.errors,n=e.auth;return{isLoading:{globals:{settings:t.globals.settings}},isError:{globals:{settings:a.globals.settings}},globals:{settings:Ue(e)},token:n.token}},{fetchSettings:Me})(Pe),qe=a(7),Ge=qe.f.create({page:{flexDirection:"column"},headerContainer:{flexDirection:"row",padding:40,width:"100%",alignItems:"center"},smallText:{fontSize:10,paddingBottom:1}}),He=function(e){var t=e.companyName,a=e.companyPhoneNumber,n=e.companyEmail,l=e.companyZip,o=e.companyAddress,s=e.companyCityState,i=e.companyOpeningStatement,c=e.allRooms,m=e.allImages,u=e.fullName,p=e.address,d=e.cityState,h=e.zipCode,b=e.insuranceCarrier,g=e.policyNumber,f=e.invoiceUUID,E=e.totalCost,v=e.creditApplied;return r.a.createElement(qe.a,{title:"Invoice for ".concat(u," - $").concat(E)},r.a.createElement(qe.e,{size:"LETTER",style:Ge.page},r.a.createElement(qe.h,{style:[Ge.headerContainer,{justifyContent:"space-between"}],fixed:!0},r.a.createElement(qe.h,{style:{width:40}},r.a.createElement(qe.b,{src:te.a,style:{width:"100%"}})),r.a.createElement(qe.h,{style:{flexDirection:"row",alignItems:"center"}},r.a.createElement(qe.h,{style:{alignItems:"right",marginRight:"2%"}},r.a.createElement(qe.g,{style:Ge.smallText},t),r.a.createElement(qe.g,{style:Ge.smallText},"Telephone | ".concat(a)),r.a.createElement(qe.g,{style:Ge.smallText},"Billing Email | ".concat(n)),r.a.createElement(qe.g,{style:Ge.smallText},"Mailing Address | ".concat(o," ").concat(s," ").concat(l))),r.a.createElement(qe.b,{src:"/invoices/".concat(f,"/qr"),style:{width:40}}))),r.a.createElement(qe.h,{style:{flexDirection:"column",justifyContent:"center",flexGrow:1}},r.a.createElement(qe.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},r.a.createElement(qe.g,{style:[Ge.smallText,{width:"30%"}]},"Customer Name"),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"70%",flexWrap:"wrap"}]},u)),r.a.createElement(qe.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},r.a.createElement(qe.g,{style:[Ge.smallText,{width:"30%"}]},"Property Address"),r.a.createElement(qe.h,{style:{flexDirection:"column",width:"70%"}},r.a.createElement(qe.g,{style:Ge.smallText},p),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(d," ").concat(h)))),r.a.createElement(qe.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},r.a.createElement(qe.g,{style:[Ge.smallText,{width:"30%"}]},"Insurance Carrier"),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"70%",flexWrap:"wrap"}]},b)),r.a.createElement(qe.h,{style:{flexDirection:"row",width:"80%",alignSelf:"center",paddingVertical:20}},r.a.createElement(qe.g,{style:[Ge.smallText,{width:"30%"}]},"Policy Number"),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"70%",flexWrap:"wrap"}]},g)),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"80%",borderTop:"1 solid black",alignSelf:"center",paddingTop:10}]},i)),r.a.createElement(qe.h,{style:{flexDirection:"column",width:"90%",alignSelf:"center",minHeight:500},break:!0},c.map(function(e){return r.a.createElement(qe.h,{style:{flexDirection:"column",width:"100%",marginBottom:30}},r.a.createElement(qe.h,{style:{flexDirection:"row",justifyContent:"space-between",borderBottom:"1 solid black",paddingBottom:5,marginBottom:8}},r.a.createElement(qe.g,{style:Ge.smallText},e.name),r.a.createElement(qe.g,{style:Ge.smallText},"L: ".concat(e.length," | W: ").concat(e.width," | H: ").concat(e.height))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Square Footage of Floor"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.SFFloor," sq. ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Square Footage of Ceiling"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.SFCeiling," sq. ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Square Footage of Walls"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.SFWalls," sq. ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Square Footage of Walls & Ceiling"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.SFWallsCeiling," sq. ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Square Footage of Walls, Floor & Ceiling"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.SFWallsFloorCeiling," sq. ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Linear Footage of Floor Perimeter"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.LFFloorPerim," ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Linear Footage of Ceiling Perimeter"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.LFCeilingPerim," ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Linear Footage of Floor & Ceiling Perimeter"),r.a.createElement(qe.g,{style:Ge.smallText},"".concat(e.LFFloorCeilingPerim," ft."))),r.a.createElement(qe.h,{style:{flexDirection:"row",justifyContent:"center",borderBottom:"1 solid gray",paddingBottom:5,marginTop:10,marginBottom:5}},r.a.createElement(qe.g,{style:[Ge.smallText,{width:"20%"}]},"Qty"),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"50%"}]},"Description"),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"10%"}]},"Labor Cost"),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"10%"}]},"Unit Cost"),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"10%",textAlign:"right"}]},"Total")),e.lineItems.map(function(e){return r.a.createElement(qe.h,{style:{flexDirection:"row",justifyContent:"center",paddingBottom:10}},r.a.createElement(qe.g,{style:[Ge.smallText,{width:"20%"}]},"".concat(e.quantity," ").concat(e.uom)),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"50%",flexWrap:"wrap",paddingRight:1}]},e.description),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"10%"}]},"$",e.laborCost),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"10%"}]},"$",e.materialCost),r.a.createElement(qe.g,{style:[Ge.smallText,{width:"10%",textAlign:"right"}]},"$",e.total))}),r.a.createElement(qe.h,{style:{flexDirection:"row",justifyContent:"space-between",borderBottom:"1 solid black",paddingBottom:5,marginBottom:5}},r.a.createElement(qe.g,{style:Ge.smallText},"Totals - ".concat(e.name)),r.a.createElement(qe.g,{style:Ge.smallText},"Labor Totals: $".concat(e.roomTotals.totalLabor," | Unit Totals: $").concat(e.roomTotals.totalMaterial," | Totals: $").concat(e.roomTotals.totalCost))))})),r.a.createElement(qe.h,{style:{flexDirection:"column",width:"90%",alignSelf:"center"},break:!0},r.a.createElement(qe.g,{style:[Ge.smallText,{marginBottom:10}],fixed:!0},m.length>0&&"Images"),r.a.createElement(qe.h,{style:{flexDirection:"row",width:"100%",alignSelf:"center",flexWrap:"wrap"},break:!0},m.map(function(e){return r.a.createElement(qe.b,{src:e,style:{width:"40%",marginRight:10,marginBottom:10}})}))),r.a.createElement(qe.h,{style:{flexDirection:"column",width:"90%",alignSelf:"center",minHeight:500},break:!0},r.a.createElement(qe.g,{style:[Ge.smallText,{textAlign:"right",textDecoration:"underline"}]},"Totals"),c.map(function(e){return r.a.createElement(qe.h,{style:{flexDirection:"row",marginBottom:2,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},e.name),r.a.createElement(qe.g,{style:Ge.smallText},"$",e.roomTotals.totalCost))}),r.a.createElement(qe.h,{style:{flexDirection:"row",marginTop:20,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Credit Applied"),r.a.createElement(qe.g,{style:Ge.smallText},"- $",v)),r.a.createElement(qe.h,{style:{flexDirection:"row",marginTop:20,justifyContent:"space-between"}},r.a.createElement(qe.g,{style:[Ge.smallText,{marginRight:20}]},"Total Amount"),r.a.createElement(qe.g,{style:Ge.smallText},"$",E))),r.a.createElement(qe.h,{style:{flexDirection:"column",width:"80%",position:"absolute",bottom:0,borderTop:"1 solid gray",paddingVertical:10,marginBottom:10,alignSelf:"center"},fixed:!0},r.a.createElement(qe.g,{style:[Ge.smallText,{color:"gray",textAlign:"center"}],render:function(e){e.pageNumber,e.totalPages;return"Invoice for ".concat(u," - Invoice ID : ").concat(f)}}))))},Ke=function(e){function t(e){var a;return Object(q.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).state={invoice:null},a}return Object(W.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("the invoiceid is",this.props.match.params),I.a.setToken(this.props.token),I.a.requests.get("invoices/".concat(this.props.match.params.invoiceId)).then(function(t){var a=t.invoice;e.setState({invoice:a})}).catch(function(t){404===t.status&&(e.props.history.push("/"),e.setState({invoice:null}))})}},{key:"render",value:function(){var e=this.props.globals.settings,t=(e.companyName,e.companyPhoneNumber,[]),a=[],n={},l={},o="",s="",i="".concat(X(),".pdf"),c="";if(this.state.invoice){var m=Object.keys(this.state.invoice.rooms||{}),u=this.state.invoice.rooms;t=m.map(function(e){var t=u[e],a=Object.keys(t.lineItems),n=t.lineItems,l=a.map(function(e){return n[e]}),r=function(e,t,a){var n,l,r,o,s;return{SFFloor:n=e*t,SFCeiling:l=e*t,SFWalls:r=2*(e*a+t*a),SFWallsCeiling:r+l,SFWallsFloorCeiling:r+n+l,LFFloorPerim:o=2*e+2*t,LFCeilingPerim:s=2*e+2*t,LFFloorCeilingPerim:o+s}}(t.length,t.width,t.height);return Object(p.a)({},r,t,{lineItems:l})});var d=Object.keys(this.state.invoice.images||{}),h=this.state.invoice.images;a=d.map(function(e){return h[e].url}),n=this.state.invoice.customer,l=this.state.invoice.claim,o=this.state.invoice.id,s=this.state.invoice.totalCost,c=this.state.invoice.creditToApply,i="".concat(n.fullName.replace(/\s+/g,""),"-").concat(o,".pdf")}return r.a.createElement("div",{className:"flex flex-column justify-center pv4 ph2 w-100"},r.a.createElement(qe.c,{document:r.a.createElement(He,Object.assign({},this.props.globals.settings,{allRooms:t||[],allImages:a},n,l,{invoiceUUID:o,totalCost:s,creditApplied:c,pdfVersion:"VERSION_1"})),fileName:i,className:"dinTitle f4 mid-gray center mv4",key:X()},function(e){e.blob,e.url;var t=e.loading;e.error;return t?"Loading document...":"Download PDF"}),r.a.createElement(qe.d,{height:"800px",className:"center w-90 w-60-l",key:X()},r.a.createElement(He,Object.assign({},this.props.globals.settings,{allRooms:t||[],allImages:a},n,l,{invoiceUUID:o,totalCost:s,creditApplied:c,pdfVersion:"VERSION_1"}))))}}]),t}(l.Component),We=Object(i.c)(function(e){var t=e.status,a=e.errors,n=e.auth;return{isLoading:{globals:{settings:t.globals.settings}},isError:{globals:{settings:a.globals.settings}},globals:{settings:Ue(e)},token:n.token}},{fetchSettings:Me})(Ke),Ve=function(e){return r.a.createElement("div",null,"Not Found ")},Ze=function(e){function t(e){var a;return Object(q.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).logout=a.logout.bind(Object(Y.a)(Object(Y.a)(a))),a}return Object(W.a)(t,e),Object(G.a)(t,[{key:"componentDidMount",value:function(){this.props.initApp()}},{key:"logout",value:function(){this.props.logout()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(ae,{onLogout:this.logout}),r.a.createElement("main",null,r.a.createElement(J.a,null,r.a.createElement(Z.a,{exact:!0,path:this.props.match.path,component:Oe}),r.a.createElement(Z.a,{path:this.props.match.path+"invoices/new/:draftId",component:Re}),r.a.createElement(Z.a,{path:"".concat(this.props.match.path,"settings"),component:Be}),r.a.createElement(Z.a,{path:"".concat(this.props.match.path,"invoices/pdf/:invoiceId"),exact:!0,component:We}),r.a.createElement(Z.a,{path:"/*",component:Ve}))))}}]),t}(l.Component),Qe=Object(i.c)(null,{logout:function(){return{type:"LOGOUT"}},initApp:function(){return function(e){return e({type:"INIT_APP",payload:new Promise(function(t,a){var n=Promise.all([e(be()),e(he()),e(Me())]),l=new Promise(function(e,t){setTimeout(function(){return t("Timeout")},1e4)});return Promise.race([n,l]).then(function(){return t()}).catch(function(e){return a(e)})})})}}})(Ze),Je=a(39),Ye=function(e){function t(e){var a;return Object(q.a)(this,t),(a=Object(H.a)(this,Object(K.a)(t).call(this,e))).login=a.login.bind(Object(Y.a)(Object(Y.a)(a))),a.handleChange=a.handleChange.bind(Object(Y.a)(Object(Y.a)(a))),a.state={email:"",password:""},a}return Object(W.a)(t,e),Object(G.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(ne.a)({},e.target.name,e.target.value))}},{key:"componentDidMount",value:function(){var e=this.props.location.state;this.props.isAuth&&(e?this.props.push(this.props.location.state.from):this.props.push("/"))}},{key:"login",value:function(){this.props.attemptLogin(this.state.email,this.state.password).catch(function(e){if(401===e.response.statusCode||403===e.response.statusCode)return alert("Your email or password is incorrect"),void console.log("this is the error -----\x3e",e);alert("there was an error"),console.log("this is the error -----\x3e",e)})}},{key:"componentDidUpdate",value:function(){var e=this.props.location.state;this.props.isAuth&&(e?this.props.push(this.props.location.state.from):this.props.push("/"))}},{key:"render",value:function(){return r.a.createElement("div",{className:"w-100 vh-100 flex flex-column ph2 justify-center flex-row-l items-center measure-1024 center"},r.a.createElement("div",{className:"fl w-90 w-50-l flex flex-column items-center"},r.a.createElement("p",{className:"self-start dinTitle"},"Welcome back,",r.a.createElement("br",null),"Sign in.",r.a.createElement("span",{className:"db mt3"},r.a.createElement("img",{src:te.a,width:"25%",height:"auto",alt:""})))),r.a.createElement("div",{className:"fl w-90 w-50-l flex flex-column items-center"},r.a.createElement("div",{className:"self-start w-100 measure ph3"},r.a.createElement("input",{className:"InputField",type:"email",name:"email",value:this.state.email,placeholder:"Knack Email",onChange:this.handleChange}),r.a.createElement("input",{className:"InputField",type:"password",name:"password",value:this.state.password,placeholder:"Knack Password",onChange:this.handleChange}),r.a.createElement("button",{className:"flex flex-row items-center dinLabel f7 blue self-start pointer bn bg-transparent mt3",onClick:this.login,disabled:this.props.loading},"SIGN IN ",r.a.createElement("div",{className:"ArrowIcon mh2"},r.a.createElement($,null))))))}}]),t}(l.Component),ze=Object(i.c)(function(e){return{isAuth:e.auth.isAuth,loading:e.status.authLoading}},{push:Je.d,test:function(){return{type:"CHANGE"}},attemptLogin:function(e,t){return function(a){return a({type:"LOGIN",payload:I.a.Auth.login(e,t).then(function(e){return e.isAuth?e:Promise.reject(e)})})}}})(Ye),Xe=(a(534),Object(i.c)(function(e){return{isAuth:e.auth.isAuth}},null)(function(e){var t=e.component,a=e.isAuth,n=Object(V.a)(e,["component","isAuth"]);return r.a.createElement(Z.a,Object.assign({},n,{render:function(e){return a?r.a.createElement(t,e):r.a.createElement(Q.a,{to:{pathname:"/login",state:{from:e.location}}})}}))})),$e=function(e){function t(){return Object(q.a)(this,t),Object(H.a)(this,Object(K.a)(t).apply(this,arguments))}return Object(W.a)(t,e),Object(G.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(J.a,null,r.a.createElement(Z.a,{path:"/login",exact:!0,component:ze}),r.a.createElement(Xe,{path:"/",component:Qe})))}}]),t}(l.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var et=B(),tt=et.store,at=et.persistor;s.a.render(r.a.createElement(i.a,{store:tt},r.a.createElement(c.a,{loading:null,persistor:at},r.a.createElement(m.a,{history:R},r.a.createElement($e,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[299,1,2]]]);
//# sourceMappingURL=main.3c88a7f6.chunk.js.map